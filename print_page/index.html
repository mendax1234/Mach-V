
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A high-performance RISC-V processor on FPGA. Bridging the gap between beginner-friendly education and advanced hardware architecture.">
      
      
        <meta name="author" content="Wenbo (Daniel) Zhu">
      
      
        <link rel="canonical" href="https://mendax1234.github.io/Hydra-V/print_page/">
      
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Print Site - Hydra-V Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../css/timeago.css">
    
    <script>__md_scope=new URL("/Hydra-V/",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#index" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Hydra-V Docs" class="md-header__button md-logo" aria-label="Hydra-V Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Hydra-V Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/mendax1234/Hydra-V" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mendax1234/Hydra-V
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../uarch/" class="md-tabs__link">
          
  
  
    
  
  Microarchitecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../sim/simulation/" class="md-tabs__link">
        
  
  
    
  
  Simulation

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../sw/" class="md-tabs__link">
          
  
  
    
  
  Software

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Hydra-V Docs" class="md-nav__button md-logo" aria-label="Hydra-V Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Hydra-V Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mendax1234/Hydra-V" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mendax1234/Hydra-V
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../uarch/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Microarchitecture
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Microarchitecture
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../uarch/mul-div/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Multiply & Divide Unit
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Multiply & Divide Unit
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../uarch/mul-div/native-design/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 15.5A3.5 3.5 0 0 1 8.5 12 3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97s-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1s.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64z"/></svg>
  
  <span class="md-ellipsis">
    
  
    Native Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../uarch/mul-div/vendor-ip/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2 10.96a.985.985 0 0 1-.37-1.37L3.13 7c.11-.2.28-.34.47-.42l7.83-4.4c.16-.12.36-.18.57-.18s.41.06.57.18l7.9 4.44c.19.1.35.26.44.46l1.45 2.52c.28.48.11 1.09-.36 1.36l-1 .58v4.96c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18s-.41-.06-.57-.18l-7.9-4.44A.99.99 0 0 1 3 16.5v-5.54c-.3.17-.68.18-1 0m10-6.81v6.7l5.96-3.35zM5 15.91l6 3.38v-6.71L5 9.21zm14 0v-3.22l-5 2.9c-.33.18-.7.17-1 .01v3.69zm-5.15-2.55 6.28-3.63-.58-1.01-6.28 3.63z"/></svg>
  
  <span class="md-ellipsis">
    
  
    AMD IP Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sim/simulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simulation
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../sw/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Software
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Software
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sw/benchmark/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m16 11.78 4.24-7.33 1.73 1-5.23 9.05-6.51-3.75L5.46 19H22v2H2V3h2v14.54L9.5 8z"/></svg>
  
  <span class="md-ellipsis">
    
  
    Benchmark
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sw/uart_calculator/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 2h10a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m0 2v4h10V4zm0 6v2h2v-2zm4 0v2h2v-2zm4 0v2h2v-2zm-8 4v2h2v-2zm4 0v2h2v-2zm4 0v2h2v-2zm-8 4v2h2v-2zm4 0v2h2v-2zm4 0v2h2v-2z"/></svg>
  
  <span class="md-ellipsis">
    
  
    UART Calculator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sw/resources/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 21.5c-1.35-.85-3.8-1.5-5.5-1.5-1.65 0-3.35.3-4.75 1.05-.1.05-.15.05-.25.05-.25 0-.5-.25-.5-.5V6c.6-.45 1.25-.75 2-1 1.11-.35 2.33-.5 3.5-.5 1.95 0 4.05.4 5.5 1.5 1.45-1.1 3.55-1.5 5.5-1.5 1.17 0 2.39.15 3.5.5.75.25 1.4.55 2 1v14.6c0 .25-.25.5-.5.5-.1 0-.15 0-.25-.05-1.4-.75-3.1-1.05-4.75-1.05-1.7 0-4.15.65-5.5 1.5M12 8v11.5c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5V7c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5m1 3.5c1.11-.68 2.6-1 4.5-1 .91 0 1.76.09 2.5.28V9.23c-.87-.15-1.71-.23-2.5-.23q-2.655 0-4.5.84zm4.5.17c-1.71 0-3.21.26-4.5.79v1.69c1.11-.65 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24v-1.5c-.87-.16-1.71-.23-2.5-.23m2.5 2.9c-.87-.16-1.71-.24-2.5-.24-1.83 0-3.33.27-4.5.8v1.69c1.11-.66 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24z"/></svg>
  
  <span class="md-ellipsis">
    
  
    Resources
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    <span class="md-ellipsis">
      
        1 Home
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2 Microarchitecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 Microarchitecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#uarch" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Microarchitecture of Hydra-V Processor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-2-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Multiply & Divide Unit
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2 Multiply &amp; Divide Unit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#uarch-mul-div" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.1 Multiply &amp; Divide Unit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uarch-mul-div-native-design" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.2 Native Design
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uarch-mul-div-vendor-ip" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.3 AMD IP Design
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sim-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        3 Simulation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-4" class="md-nav__link">
    <span class="md-ellipsis">
      
        4 Software
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4 Software">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sw" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Software Development Guide
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sw-benchmark" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Benchmark
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sw-uart_calculator" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3 UART Calculator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sw-resources" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.4 Resources
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


              
              <article class="md-content__inner md-typeset">
                
                  



<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index" heading-number="1"><p>Welcome to the <strong>Hydra-V Documentation</strong>!</p></section>
                    <section class='print-page md-section' id='section-2' heading-number='2'>
                        <h1>Microarchitecture<a class='headerlink' href='#section-2' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="uarch" heading-number="2.1"><h1 id="uarch-microarchitecture-of-hydra-v-processor">Microarchitecture of Hydra-V Processor<a class="headerlink" href="#uarch-microarchitecture-of-hydra-v-processor" title="Permanent link">&para;</a></h1>
<p>The microarchitecture of Hydra-V is shown in the figure below:</p>
<p><img alt="System Architecture" src="../assets/images/Hydra-V-0.1.svg" /></p></section>
                    <section class='print-page md-section' id='section-2-2' heading-number='2.2'>
                        <h1>Multiply & Divide Unit<a class='headerlink' href='#section-2-2' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="uarch-mul-div" heading-number="2.2.1"><h1 id="uarch-mul-div-multiply-divide-unit">Multiply &amp; Divide Unit<a class="headerlink" href="#uarch-mul-div-multiply-divide-unit" title="Permanent link">&para;</a></h1>
<p>In this version of the Hydra-V processor, the multiply and divide unit is incorporated into one file called <code>MCycle.v</code>. The whole idea of the <code>MCycle</code> module is that, while it is doing the computation, the <code>Busy</code> signal (output) will be triggered high and this signal will be used to stall the other relevant pipeline registers so that no new instructions are fetched until the multiplication/division is complete.</p>
<p>This module is implemented using the mealy state machine.</p>
<h2 id="uarch-mul-div-state-machine-control">State Machine Control<a class="headerlink" href="#uarch-mul-div-state-machine-control" title="Permanent link">&para;</a></h2>
<h2 id="uarch-mul-div-implementation-details">Implementation Details<a class="headerlink" href="#uarch-mul-div-implementation-details" title="Permanent link">&para;</a></h2>
<p>I have tried two implementations for the <code>MCycle</code> module:</p>
<div class="grid cards">
<ul>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 4h10c1.11 0 2 .89 2 2v2h-3.41L16 10.59v4l-2 2V20h-4v-3.41l-2-2V9.41l2-2zm8 7.41V14h4v-4h-2.59zM6.59 8 8 6.59V4H4c-1.11 0-2 .89-2 2v2zM6 14v-4H2v4zm2 3.41L6.59 16H2v2c0 1.11.89 2 2 2h4zM17.41 16 16 17.41V20h4c1.11 0 2-.89 2-2v-2z"/></svg></span> <strong>Native Design</strong></p>
<hr />
<p>Implement the multiply and divide unit by "hand-typped" Verilog code.</p>
<p><a href="#uarch-mul-div-native-design"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0"/></svg></span> View Documentation</a></p>
</li>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.123 24q-.303 0-.603-.017a.5.5 0 0 1-.043-.287.7.7 0 0 0-.022-.263h-2.23a1.2 1.2 0 0 1-.785.39.7.7 0 0 1-.507-.228.915.915 0 0 1-.065-1.1.7.7 0 0 1 .557-.266 1.22 1.22 0 0 1 .703.267h2.328a2 2 0 0 0 0-.614H10.26a1.14 1.14 0 0 1-.55-.13 22 22 0 0 0-1.487-.808 1.4 1.4 0 0 0-.71-.194 7 7 0 0 1-.476.015q-.236-.001-.464-.007a19 19 0 0 0-.45-.008 1.35 1.35 0 0 1-.814.37.68.68 0 0 1-.512-.24.76.76 0 0 1 0-1.067.72.72 0 0 1 .537-.272 1.3 1.3 0 0 1 .756.337h1.681a1.14 1.14 0 0 1 .55.129c.14.082.293.162.441.239a6 6 0 0 1 .754.44 1.95 1.95 0 0 0 1.116.33 3 3 0 0 0 .178-.007 2 2 0 0 1 .219-.014q.101 0 .208.007c.08.004.161.007.251.007v-1.034h-1.164a1.27 1.27 0 0 1-.71.3.84.84 0 0 1-.615-.332c-.37-.404-.134-.803.13-1.067a.56.56 0 0 1 .353-.125 1.35 1.35 0 0 1 .842.448h1.1v-.905a.4.4 0 0 0-.178-.04q-.04 0-.083.004-.044.003-.095.004H4.959a.84.84 0 0 1-.743-.356c-.172-.228-.37-.459-.545-.663l-.07-.08c-.743-.065-.97-.285-.937-.905a.75.75 0 0 1 .84-.679c.492 0 .711.33.711 1.067q.09.105.183.22c.136.164.276.335.432.491h6.658a5.5 5.5 0 0 0 0-1.034H6.64a1.32 1.32 0 0 1-.795.37.66.66 0 0 1-.498-.24.746.746 0 0 1 0-1.1.7.7 0 0 1 .508-.268 1.17 1.17 0 0 1 .72.365h4.88v-1.002H3.215q-.234.259-.502.535c-.158.166-.321.337-.5.531a.84.84 0 0 1-.792.752 1 1 0 0 1-.114-.008.846.846 0 0 1-.646-1.002c.059-.383.372-.602.86-.602a2 2 0 0 1 .271.02c.177-.206.444-.508.711-.776a.96.96 0 0 1 .776-.323h8.177v-1.099H1.63a1.23 1.23 0 0 1-.744.344.68.68 0 0 1-.55-.312.85.85 0 0 1 .098-1.13.75.75 0 0 1 .479-.195 1.15 1.15 0 0 1 .814.485h3.2l-.102-.097c-.56-.528-1.138-1.075-1.838-1.713a.755.755 0 0 1-.776-.808c0-.514.22-.743.711-.743.662 0 .84.212.873 1.034.248.238.492.469.75.713.543.513 1.102 1.042 1.674 1.614h5.236v-.743H9.161a1.28 1.28 0 0 1-.705.263.75.75 0 0 1-.588-.296.81.81 0 0 1 .129-1.098.64.64 0 0 1 .437-.168 1.28 1.28 0 0 1 .824.394h2.198v-.84q-.342-.001-.671-.008h-.007a39 39 0 0 0-.656-.007c-.248 0-.467.005-.67.014a1 1 0 0 1-.115.005 1.23 1.23 0 0 1-.855-.36l-.6-.507-.012-.01-.008-.007A261 261 0 0 0 6.64 7.272H3.052a1.24 1.24 0 0 1-.72.29.73.73 0 0 1-.573-.29.776.776 0 0 1 .097-1.099.7.7 0 0 1 .474-.223 1.36 1.36 0 0 1 .819.45h3.135a1.6 1.6 0 0 1 1.164.452c.373.351.795.69 1.203 1.019h.001c.19.153.388.311.573.466h2.198V7.271c-.138 0-.282-.004-.42-.007H11a18 18 0 0 0-.44-.008q-.24 0-.428.015a1 1 0 0 1-.115.005 1.34 1.34 0 0 1-.856-.327 11 11 0 0 0-.305-.24c-.103-.08-.212-.162-.31-.245-.8-.064-1.098-.29-1.066-.808a.776.776 0 0 1 .776-.743c.497 0 .775.302.808.872.129.097.258.204.388.307l.001.002c.127.103.259.21.388.306h1.584V5.14h-.55a1.35 1.35 0 0 1-.765.36.69.69 0 0 1-.528-.296.8.8 0 0 1 .033-1.1.7.7 0 0 1 .5-.214 1.1 1.1 0 0 1 .759.376h.517a.5.5 0 0 0 .043-.346 1 1 0 0 1-.01-.138v-.517a3 3 0 0 1-.292.012 9 9 0 0 1-.355-.01h-.007a8 8 0 0 0-.364-.01 1.96 1.96 0 0 0-1.018.234 11 11 0 0 1-1.115.582H8.27c-.153.073-.312.148-.466.224a.9.9 0 0 1-.42.065H5.22a1.1 1.1 0 0 1-.696.328.78.78 0 0 1-.598-.327.72.72 0 0 1-.181-.545.85.85 0 0 1 .31-.586.74.74 0 0 1 .473-.197 1.07 1.07 0 0 1 .755.456h2.101a.6.6 0 0 0 .223-.053 1 1 0 0 1 .133-.044q.197-.099.39-.19a10 10 0 0 0 .935-.489 2.56 2.56 0 0 1 1.353-.362q.097 0 .198.006a2 2 0 0 0 .258.014q.127 0 .26-.006h.001q.138-.007.286-.008a2.1 2.1 0 0 0 .037-.59q-.004-.105-.004-.218H9.416a1.46 1.46 0 0 1-.766.332.68.68 0 0 1-.526-.3.83.83 0 0 1 .065-1.098.72.72 0 0 1 .487-.205 1.24 1.24 0 0 1 .776.366h2.004q.002-.133.014-.276c.009-.114.018-.231.018-.37h.126c4.196 0 7.492 1.642 9.797 4.88a12.23 12.23 0 0 1 2.408 6.457c.12 2.203-.44 4.457-1.665 6.698a11.4 11.4 0 0 1-4.433 4.477A11.5 11.5 0 0 1 12.123 24m.367-5.577v4.46a1.6 1.6 0 0 0 .27.022 3.5 3.5 0 0 0 .491-.045c.11-.015.22-.033.337-.041a15 15 0 0 0 2.392-4.396zm4.654 0a19 19 0 0 1-1.842 3.944 10.38 10.38 0 0 0 5.3-3.944zm1.035-5.785a20.5 20.5 0 0 1-.68 4.654h3.815a11.2 11.2 0 0 0 1.293-4.654zm-5.69 0v4.622h3.88a18.2 18.2 0 0 0 .678-4.622zm.033-5.786v4.654h4.557a18.7 18.7 0 0 0-.71-4.654zm4.945-.032a21.4 21.4 0 0 1 .711 4.654h4.428a10.9 10.9 0 0 0-1.325-4.654zM15.27 1.778a20 20 0 0 1 1.875 3.943h3.459a10.6 10.6 0 0 0-5.333-3.943zm-2.747-.582c0 1.562 0 3.038.032 4.493h3.459a.12.12 0 0 1-.032-.097 16.2 16.2 0 0 0-2.23-4.105l-.038-.04a.28.28 0 0 0-.189-.122 10 10 0 0 0-1.002-.13"/></svg></span> <strong>Using IP Cores</strong></p>
<hr />
<p>Use Xilinx IP cores to implement the multiply and divide unit.</p>
<p><a href="#uarch-mul-div-vendor-ip"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0"/></svg></span> View Documentation</a></p>
</li>
</ul>
</div></section><section class="print-page" id="uarch-mul-div-native-design" heading-number="2.2.2"><h1 id="uarch-mul-div-native-design-native-design-of-multiply-divide-unit">Native Design of Multiply &amp; Divide Unit<a class="headerlink" href="#uarch-mul-div-native-design-native-design-of-multiply-divide-unit" title="Permanent link">&para;</a></h1>
<p>This is a follow-up from <a href="https://nus-cg3207.github.io/labs/asst_manuals/Asst_03/Asst_03/">CG3207 Assignment 3</a>. More specifically, it is my try to finish the first bullet point in the <a href="https://nus-cg3207.github.io/labs/asst_manuals/Asst_03/Asst_03/#task-3-enhancements-5-points">Task 3 of this assignment</a>.</p>
<h2 id="uarch-mul-div-native-design-multiply-unit">Multiply Unit<a class="headerlink" href="#uarch-mul-div-native-design-multiply-unit" title="Permanent link">&para;</a></h2>
<p>For the multiply unit, the idea is to "unroll" the loop. For the 32-bit multiplication, instead of using 32 cycles to compute the result by shifting 1 bit a time, I generate the partial products for every 8 bits of the multiplier in parallel. So, the temporal product here will be <span class="arithmatex">\(32+8=40\)</span> bits wide.</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#uarch-mul-div-native-design-__codelineno-0-1"></a><span class="k">module</span><span class="w"> </span><span class="n">Multiplier32x8</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#uarch-mul-div-native-design-__codelineno-0-2"></a><span class="w">    </span><span class="k">input</span><span class="w">  </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w">       </span><span class="c1">// The 32-bit full operand</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#uarch-mul-div-native-design-__codelineno-0-3"></a><span class="w">    </span><span class="k">input</span><span class="w">  </span><span class="p">[</span><span class="w"> </span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w">       </span><span class="c1">// The 8-bit slice</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#uarch-mul-div-native-design-__codelineno-0-4"></a><span class="w">    </span><span class="k">output</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">Product</span><span class="w">  </span><span class="c1">// Result (32 + 8 = 40 bits max)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#uarch-mul-div-native-design-__codelineno-0-5"></a><span class="p">);</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#uarch-mul-div-native-design-__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#uarch-mul-div-native-design-__codelineno-0-7"></a><span class="w">    </span><span class="c1">// // Generate Partial Products (Shift A based on bit position of B)</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#uarch-mul-div-native-design-__codelineno-0-8"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">8</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#uarch-mul-div-native-design-__codelineno-0-9"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">7</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#uarch-mul-div-native-design-__codelineno-0-10"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">6</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#uarch-mul-div-native-design-__codelineno-0-11"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">5</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">3</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#uarch-mul-div-native-design-__codelineno-0-12"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">4</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">4</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#uarch-mul-div-native-design-__codelineno-0-13"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">5</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">3</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">5</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#uarch-mul-div-native-design-__codelineno-0-14"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">6</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">6</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#uarch-mul-div-native-design-__codelineno-0-15"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">7</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">7</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#uarch-mul-div-native-design-__codelineno-0-16"></a>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#uarch-mul-div-native-design-__codelineno-0-17"></a><span class="w">    </span><span class="c1">// Sum them up (Tree adder is faster, but this simple chain works also)</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#uarch-mul-div-native-design-__codelineno-0-18"></a><span class="w">    </span><span class="k">assign</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pp0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp7</span><span class="p">;</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#uarch-mul-div-native-design-__codelineno-0-19"></a>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#uarch-mul-div-native-design-__codelineno-0-20"></a><span class="k">endmodule</span>
</span></code></pre></div>
<p>In this module, the input <code>A</code> is the full 32-bit multiplicand, while <code>B</code> is an 8-bit slice of the multiplier. The output <code>Product</code> is the 40-bit partial product. For the sliced version of the multiplier, it can be implemented as follows in the state machine control:</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#uarch-mul-div-native-design-__codelineno-1-1"></a><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">])</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#uarch-mul-div-native-design-__codelineno-1-2"></a><span class="w">    </span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="o">:</span><span class="w"> </span><span class="n">current_byte_op2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs_op2</span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#uarch-mul-div-native-design-__codelineno-1-3"></a><span class="w">    </span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="o">:</span><span class="w"> </span><span class="n">current_byte_op2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs_op2</span><span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">8</span><span class="p">];</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#uarch-mul-div-native-design-__codelineno-1-4"></a><span class="w">    </span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="o">:</span><span class="w"> </span><span class="n">current_byte_op2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs_op2</span><span class="p">[</span><span class="mh">23</span><span class="o">:</span><span class="mh">16</span><span class="p">];</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#uarch-mul-div-native-design-__codelineno-1-5"></a><span class="w">    </span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="o">:</span><span class="w"> </span><span class="n">current_byte_op2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs_op2</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">24</span><span class="p">];</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#uarch-mul-div-native-design-__codelineno-1-6"></a><span class="k">endcase</span>
</span></code></pre></div>
<p>The final product is then obtained by summing up the 4 partial products with appropriate shifts, which can be implemented as follows:</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#uarch-mul-div-native-design-__codelineno-2-1"></a><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#uarch-mul-div-native-design-__codelineno-2-2"></a><span class="w">    </span><span class="mh">1</span><span class="o">:</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">partial_product_out</span><span class="p">;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#uarch-mul-div-native-design-__codelineno-2-3"></a><span class="w">    </span><span class="mh">2</span><span class="o">:</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">partial_product_out</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mh">8</span><span class="p">);</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#uarch-mul-div-native-design-__codelineno-2-4"></a><span class="w">    </span><span class="mh">3</span><span class="o">:</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">partial_product_out</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mh">16</span><span class="p">);</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#uarch-mul-div-native-design-__codelineno-2-5"></a><span class="w">    </span><span class="mh">4</span><span class="o">:</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">partial_product_out</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mh">24</span><span class="p">);</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#uarch-mul-div-native-design-__codelineno-2-6"></a><span class="k">endcase</span>
</span></code></pre></div>
<p>And lastly, this module is instantiated in the <code>MCycle</code> module as follows:</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#uarch-mul-div-native-design-__codelineno-3-1"></a><span class="n">Multiplier32x8</span><span class="w"> </span><span class="n">mul_unit</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#uarch-mul-div-native-design-__codelineno-3-2"></a><span class="w">    </span><span class="p">.</span><span class="n">A</span><span class="w">      </span><span class="p">(</span><span class="n">abs_op1</span><span class="p">),</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#uarch-mul-div-native-design-__codelineno-3-3"></a><span class="w">    </span><span class="p">.</span><span class="n">B</span><span class="w">      </span><span class="p">(</span><span class="n">current_byte_op2</span><span class="p">),</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#uarch-mul-div-native-design-__codelineno-3-4"></a><span class="w">    </span><span class="p">.</span><span class="n">Product</span><span class="p">(</span><span class="n">partial_product_out</span><span class="p">)</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#uarch-mul-div-native-design-__codelineno-3-5"></a><span class="p">);</span>
</span></code></pre></div>
<details class="tip" open="open">
<summary>Tip</summary>
<p>This technique can indeed be implementated using <code>for</code> loop in Verilog as follows:</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#uarch-mul-div-native-design-__codelineno-4-1"></a><span class="k">module</span><span class="w"> </span><span class="n">Multiplier32x8</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#uarch-mul-div-native-design-__codelineno-4-2"></a><span class="w">    </span><span class="k">input</span><span class="w">  </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w">       </span><span class="c1">// The 32-bit full operand</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#uarch-mul-div-native-design-__codelineno-4-3"></a><span class="w">    </span><span class="k">input</span><span class="w">  </span><span class="p">[</span><span class="w"> </span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w">       </span><span class="c1">// The 8-bit slice</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#uarch-mul-div-native-design-__codelineno-4-4"></a><span class="w">    </span><span class="k">output</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">Product</span><span class="w">  </span><span class="c1">// Result (32 + 8 = 40 bits max)</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#uarch-mul-div-native-design-__codelineno-4-5"></a><span class="p">);</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#uarch-mul-div-native-design-__codelineno-4-6"></a>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#uarch-mul-div-native-design-__codelineno-4-7"></a><span class="w">    </span><span class="c1">// // Generate Partial Products (Shift A based on bit position of B)</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#uarch-mul-div-native-design-__codelineno-4-8"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">8</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#uarch-mul-div-native-design-__codelineno-4-9"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">7</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#uarch-mul-div-native-design-__codelineno-4-10"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">6</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#uarch-mul-div-native-design-__codelineno-4-11"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">5</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">3</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#uarch-mul-div-native-design-__codelineno-4-12"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">4</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">4</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#uarch-mul-div-native-design-__codelineno-4-13"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">5</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">3</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">5</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#uarch-mul-div-native-design-__codelineno-4-14"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">6</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">6</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#uarch-mul-div-native-design-__codelineno-4-15"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">7</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">7</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#uarch-mul-div-native-design-__codelineno-4-16"></a>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#uarch-mul-div-native-design-__codelineno-4-17"></a><span class="w">    </span><span class="c1">// Sum them up (Tree adder is faster, but this simple chain works also)</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#uarch-mul-div-native-design-__codelineno-4-18"></a><span class="w">    </span><span class="k">assign</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pp0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp7</span><span class="p">;</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#uarch-mul-div-native-design-__codelineno-4-19"></a>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#uarch-mul-div-native-design-__codelineno-4-20"></a><span class="k">endmodule</span>
</span></code></pre></div>
<p>This is totally valid. However, the smart synthesizer will generate the same hardware for both implementations.</p>
</details>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The 8 bits design will still use more hardware than I thought, which will give around 13ns propagation delay. This will limit the Hydra-V clock frequency to 50MHz max if the clock wizard is not used!</p>
</div>
<h2 id="uarch-mul-div-native-design-divide-unit">Divide Unit<a class="headerlink" href="#uarch-mul-div-native-design-divide-unit" title="Permanent link">&para;</a></h2>
<p>Similarly, I did the unrolling for the divider unit as well. So, instead of getting at most 1 bit of quotient and remainder per cycle. Now, I can get at most 8 bits of quotient and remainder per cycle. This divider unit is implemented using the <code>for</code> loop in Verilog as follows:</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#uarch-mul-div-native-design-__codelineno-5-1"></a><span class="k">module</span><span class="w"> </span><span class="n">DivSlice8</span><span class="w"> </span><span class="p">#(</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#uarch-mul-div-native-design-__codelineno-5-2"></a><span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">32</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#uarch-mul-div-native-design-__codelineno-5-3"></a><span class="p">)</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#uarch-mul-div-native-design-__codelineno-5-4"></a><span class="w">    </span><span class="k">input</span><span class="w">      </span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">rem_in</span><span class="p">,</span><span class="w">   </span><span class="c1">// Current Remainder</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#uarch-mul-div-native-design-__codelineno-5-5"></a><span class="w">    </span><span class="k">input</span><span class="w">      </span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">div_in</span><span class="p">,</span><span class="w">   </span><span class="c1">// Current Divisor</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#uarch-mul-div-native-design-__codelineno-5-6"></a><span class="w">    </span><span class="k">input</span><span class="w">      </span><span class="p">[</span><span class="w">  </span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">quot_in</span><span class="p">,</span><span class="w">  </span><span class="c1">// Current Quotient (LSW of buffer)</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#uarch-mul-div-native-design-__codelineno-5-7"></a><span class="w">    </span><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">rem_out</span><span class="p">,</span><span class="w">  </span><span class="c1">// Next Remainder</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#uarch-mul-div-native-design-__codelineno-5-8"></a><span class="w">    </span><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">div_out</span><span class="p">,</span><span class="w">  </span><span class="c1">// Next Divisor</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#uarch-mul-div-native-design-__codelineno-5-9"></a><span class="w">    </span><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="w">  </span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">quot_out</span><span class="w">  </span><span class="c1">// Next Quotient</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#uarch-mul-div-native-design-__codelineno-5-10"></a><span class="p">);</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#uarch-mul-div-native-design-__codelineno-5-11"></a>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#uarch-mul-div-native-design-__codelineno-5-12"></a><span class="w">    </span><span class="c1">// Temporary variable for subtraction</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#uarch-mul-div-native-design-__codelineno-5-13"></a><span class="w">    </span><span class="k">integer</span><span class="w">             </span><span class="n">i</span><span class="p">;</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#uarch-mul-div-native-design-__codelineno-5-14"></a><span class="w">    </span><span class="kt">reg</span><span class="w">     </span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="nl">width:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">diff_ext</span><span class="p">;</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#uarch-mul-div-native-design-__codelineno-5-15"></a>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#uarch-mul-div-native-design-__codelineno-5-16"></a><span class="w">    </span><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#uarch-mul-div-native-design-__codelineno-5-17"></a><span class="w">        </span><span class="c1">// Initialize temporary variables with inputs</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#uarch-mul-div-native-design-__codelineno-5-18"></a><span class="w">        </span><span class="n">rem_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rem_in</span><span class="p">;</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#uarch-mul-div-native-design-__codelineno-5-19"></a><span class="w">        </span><span class="n">div_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">div_in</span><span class="p">;</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#uarch-mul-div-native-design-__codelineno-5-20"></a><span class="w">        </span><span class="n">quot_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quot_in</span><span class="p">;</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#uarch-mul-div-native-design-__codelineno-5-21"></a>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#uarch-mul-div-native-design-__codelineno-5-22"></a><span class="w">        </span><span class="c1">// Perform 8 iterations of division logic (Combinational Loop)</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#uarch-mul-div-native-design-__codelineno-5-23"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mh">8</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#uarch-mul-div-native-design-__codelineno-5-24"></a><span class="w">            </span><span class="c1">// 1. Subtract: Remainder - Divisor</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#uarch-mul-div-native-design-__codelineno-5-25"></a><span class="w">            </span><span class="n">diff_ext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">rem_out</span><span class="p">}</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="o">~</span><span class="n">div_out</span><span class="p">}</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#uarch-mul-div-native-design-__codelineno-5-26"></a>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#uarch-mul-div-native-design-__codelineno-5-27"></a><span class="w">            </span><span class="c1">// 2. Check Sign</span>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#uarch-mul-div-native-design-__codelineno-5-28"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">diff_ext</span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#uarch-mul-div-native-design-__codelineno-5-29"></a><span class="w">                </span><span class="c1">// Result Positive: Update Remainder, Shift 1 into Quotient</span>
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#uarch-mul-div-native-design-__codelineno-5-30"></a><span class="w">                </span><span class="n">rem_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">diff_ext</span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#uarch-mul-div-native-design-__codelineno-5-31"></a><span class="w">                </span><span class="n">quot_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">quot_out</span><span class="p">[</span><span class="n">width</span><span class="o">-</span><span class="mh">2</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">};</span>
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#uarch-mul-div-native-design-__codelineno-5-32"></a><span class="w">            </span><span class="k">end</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#uarch-mul-div-native-design-__codelineno-5-33"></a><span class="w">                </span><span class="c1">// Result Negative: Keep Remainder, Shift 0 into Quotient</span>
</span><span id="__span-5-34"><a id="__codelineno-5-34" name="__codelineno-5-34" href="#uarch-mul-div-native-design-__codelineno-5-34"></a><span class="w">                </span><span class="n">quot_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">quot_out</span><span class="p">[</span><span class="n">width</span><span class="o">-</span><span class="mh">2</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">};</span>
</span><span id="__span-5-35"><a id="__codelineno-5-35" name="__codelineno-5-35" href="#uarch-mul-div-native-design-__codelineno-5-35"></a><span class="w">            </span><span class="k">end</span>
</span><span id="__span-5-36"><a id="__codelineno-5-36" name="__codelineno-5-36" href="#uarch-mul-div-native-design-__codelineno-5-36"></a>
</span><span id="__span-5-37"><a id="__codelineno-5-37" name="__codelineno-5-37" href="#uarch-mul-div-native-design-__codelineno-5-37"></a><span class="w">            </span><span class="c1">// 3. Shift Divisor Right for the next step</span>
</span><span id="__span-5-38"><a id="__codelineno-5-38" name="__codelineno-5-38" href="#uarch-mul-div-native-design-__codelineno-5-38"></a><span class="w">            </span><span class="n">div_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">div_out</span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">1</span><span class="p">]};</span>
</span><span id="__span-5-39"><a id="__codelineno-5-39" name="__codelineno-5-39" href="#uarch-mul-div-native-design-__codelineno-5-39"></a><span class="w">        </span><span class="k">end</span>
</span><span id="__span-5-40"><a id="__codelineno-5-40" name="__codelineno-5-40" href="#uarch-mul-div-native-design-__codelineno-5-40"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-5-41"><a id="__codelineno-5-41" name="__codelineno-5-41" href="#uarch-mul-div-native-design-__codelineno-5-41"></a><span class="k">endmodule</span>
</span></code></pre></div>
<p>To use the result from the divider unit, the state machine control can just be modified by updating the current remainder and quotient to be the result from the divider unit after each cycle:</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#uarch-mul-div-native-design-__codelineno-6-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#uarch-mul-div-native-design-__codelineno-6-2"></a><span class="w">    </span><span class="n">rem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">next_rem</span><span class="p">;</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#uarch-mul-div-native-design-__codelineno-6-3"></a><span class="w">    </span><span class="n">div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">next_div</span><span class="p">;</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#uarch-mul-div-native-design-__codelineno-6-4"></a><span class="w">    </span><span class="n">div_result_buf</span><span class="p">[</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">next_quot</span><span class="p">;</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#uarch-mul-div-native-design-__codelineno-6-5"></a><span class="w">    </span><span class="n">div_result_buf</span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="n">width</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rem</span><span class="p">[</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#uarch-mul-div-native-design-__codelineno-6-6"></a><span class="k">end</span>
</span></code></pre></div>
<p>And finally, this divider unit is implemented as follows in the <code>MCycle</code> module:</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#uarch-mul-div-native-design-__codelineno-7-1"></a><span class="n">DivSlice8</span><span class="w"> </span><span class="n">div_unit</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#uarch-mul-div-native-design-__codelineno-7-2"></a><span class="w">    </span><span class="p">.</span><span class="n">rem_in</span><span class="w">  </span><span class="p">(</span><span class="n">rem</span><span class="p">),</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#uarch-mul-div-native-design-__codelineno-7-3"></a><span class="w">    </span><span class="p">.</span><span class="n">div_in</span><span class="w">  </span><span class="p">(</span><span class="n">div</span><span class="p">),</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#uarch-mul-div-native-design-__codelineno-7-4"></a><span class="w">    </span><span class="p">.</span><span class="n">quot_in</span><span class="w"> </span><span class="p">(</span><span class="n">div_result_buf</span><span class="p">[</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]),</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#uarch-mul-div-native-design-__codelineno-7-5"></a><span class="w">    </span><span class="p">.</span><span class="n">rem_out</span><span class="w"> </span><span class="p">(</span><span class="n">next_rem</span><span class="p">),</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#uarch-mul-div-native-design-__codelineno-7-6"></a><span class="w">    </span><span class="p">.</span><span class="n">div_out</span><span class="w"> </span><span class="p">(</span><span class="n">next_div</span><span class="p">),</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#uarch-mul-div-native-design-__codelineno-7-7"></a><span class="w">    </span><span class="p">.</span><span class="n">quot_out</span><span class="p">(</span><span class="n">next_quot</span><span class="p">)</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#uarch-mul-div-native-design-__codelineno-7-8"></a><span class="p">);</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using the unrolling techniue in the divider unit here will use a lot of hardware! iirc, the propagation delay is around 66ns for this design! Given that high propagation delay, it is impossible to use this design on Hydra-V. So, I moved on to the next section, which is to use Xilinix IP core for the multiply and divide unit.</p>
</div></section><section class="print-page" id="uarch-mul-div-vendor-ip" heading-number="2.2.3"><h1 id="uarch-mul-div-vendor-ip-amd-ip-design">AMD IP Design<a class="headerlink" href="#uarch-mul-div-vendor-ip-amd-ip-design" title="Permanent link">&para;</a></h1>
<p>As mentioned in the <a href="#uarch-mul-div-native-design">previous documentation</a>, if I only use the unrolling technique, it is impossible to reach higher frequency while keeping the cycles for multiplication and division low. Therefore, I decided to use the AMD IP cores (Multiplier and Divider) to implement the multiply and divide unit.</p>
<h2 id="uarch-mul-div-vendor-ip-generate-the-ip-core">Generate the IP Core<a class="headerlink" href="#uarch-mul-div-vendor-ip-generate-the-ip-core" title="Permanent link">&para;</a></h2>
<h3 id="uarch-mul-div-vendor-ip-multiplier-ip">Multiplier IP<a class="headerlink" href="#uarch-mul-div-vendor-ip-multiplier-ip" title="Permanent link">&para;</a></h3>
<p>The <a href="https://www.amd.com/en/products/adaptive-socs-and-fpgas/intellectual-property/multiplier.html">multiplier IP core</a> comes from AMD and can be used in Vivado directly.</p>
<p>To use the IP in Vivado, click the "IP Catalog" on the left flow navigator. Then, search for "multiplier". Click the "Multiplier" (not "Complex Multiplier"). And the configure the IP to use the following settings:</p>
<ol>
<li>In the "Basic" tab:<ul>
<li>Set Multiplier Type to "Parallel Multiplier"</li>
<li>Set <code>A</code> and <code>B</code> to be "unsigned" and "32-bit" wide</li>
<li>Set Multiplier Construction to "Use Mults"</li>
<li>Set the Optimization Options to "Speed Optimized"</li>
</ul>
</li>
<li>In the "Output and Control" tab<ul>
<li>Make sure the <code>P</code> (output) is 64-bit wide.</li>
<li>Set the Pipeline Stages to 4.</li>
</ul>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>With the above settings, the multiplier IP core will take 5 cycles to complete and the propagation is safer for the processor to reach 100MHz and higher.</p>
</div>
<h3 id="uarch-mul-div-vendor-ip-divider-ip">Divider IP<a class="headerlink" href="#uarch-mul-div-vendor-ip-divider-ip" title="Permanent link">&para;</a></h3>
<p>Simiarly, the <a href="https://www.amd.com/en/products/adaptive-socs-and-fpgas/intellectual-property/divider.html">divider IP core</a> also comes from AMD and can be used in Vivado directly.</p>
<p>Follow the similar steps as the multiplier IP core, but configure the divider using the following settings:</p>
<ol>
<li>In the "Channel Settings" tab:<ul>
<li>Set Algorithm type of "Radix 2" and Operand sign to "unsigned".</li>
<li>Change dividend and divisor width to "32".</li>
<li>Set the Remainder Type to be "Remainder" and fractional width to be "32".</li>
</ul>
</li>
<li>In the "Options" tab:<ul>
<li>Set Clocks per Division to be "1".</li>
<li>Set the flow control under AXI4-Stream settings to "Blocking".</li>
<li>Set the optimize goal under AXI4-Stream settings to "Performance".</li>
</ul>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>With the above settings, the divider IP core will take 32 cycles to complete and the propagation is safer for the processor to reach 100MHz and higher.</p>
</div>
<h2 id="uarch-mul-div-vendor-ip-use-ip-core">Use IP Core<a class="headerlink" href="#uarch-mul-div-vendor-ip-use-ip-core" title="Permanent link">&para;</a></h2>
<p>To use the two IP cores that we have generated above, we just need to know the inputs and outputs of each IP core and then instantiate them in our <code>MCycle.v</code> to replace the multiple unit and the divide unit that we have implemented manually in the <a href="#uarch-mul-div-native-design">previous section</a>.</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#uarch-mul-div-vendor-ip-__codelineno-0-1"></a><span class="c1">// Multiplier IP: 32x32 Unsigned -&gt; 64-bit Product</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#uarch-mul-div-vendor-ip-__codelineno-0-2"></a><span class="n">mult_gen_0</span><span class="w"> </span><span class="n">my_multiplier</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#uarch-mul-div-vendor-ip-__codelineno-0-3"></a><span class="w">    </span><span class="p">.</span><span class="n">CLK</span><span class="p">(</span><span class="n">CLK</span><span class="p">),</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#uarch-mul-div-vendor-ip-__codelineno-0-4"></a><span class="w">    </span><span class="p">.</span><span class="n">A</span><span class="w">  </span><span class="p">(</span><span class="n">abs_op1</span><span class="p">),</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#uarch-mul-div-vendor-ip-__codelineno-0-5"></a><span class="w">    </span><span class="p">.</span><span class="n">B</span><span class="w">  </span><span class="p">(</span><span class="n">abs_op2</span><span class="p">),</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#uarch-mul-div-vendor-ip-__codelineno-0-6"></a><span class="w">    </span><span class="p">.</span><span class="n">P</span><span class="w">  </span><span class="p">(</span><span class="n">mul_dout</span><span class="p">)</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#uarch-mul-div-vendor-ip-__codelineno-0-7"></a><span class="p">);</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#uarch-mul-div-vendor-ip-__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#uarch-mul-div-vendor-ip-__codelineno-0-9"></a><span class="c1">// Divider IP: 32/32 Unsigned -&gt; 32 Quot, 32 Rem</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#uarch-mul-div-vendor-ip-__codelineno-0-10"></a><span class="n">div_gen_0</span><span class="w"> </span><span class="n">my_divider</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#uarch-mul-div-vendor-ip-__codelineno-0-11"></a><span class="w">    </span><span class="p">.</span><span class="n">aclk</span><span class="w">                  </span><span class="p">(</span><span class="n">CLK</span><span class="p">),</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#uarch-mul-div-vendor-ip-__codelineno-0-12"></a><span class="w">    </span><span class="p">.</span><span class="n">s_axis_divisor_tvalid</span><span class="w"> </span><span class="p">(</span><span class="n">div_in_valid</span><span class="p">),</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#uarch-mul-div-vendor-ip-__codelineno-0-13"></a><span class="w">    </span><span class="p">.</span><span class="n">s_axis_divisor_tdata</span><span class="w">  </span><span class="p">(</span><span class="n">abs_op2</span><span class="p">),</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#uarch-mul-div-vendor-ip-__codelineno-0-14"></a><span class="w">    </span><span class="p">.</span><span class="n">s_axis_dividend_tvalid</span><span class="p">(</span><span class="n">div_in_valid</span><span class="p">),</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#uarch-mul-div-vendor-ip-__codelineno-0-15"></a><span class="w">    </span><span class="p">.</span><span class="n">s_axis_dividend_tdata</span><span class="w"> </span><span class="p">(</span><span class="n">abs_op1</span><span class="p">),</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#uarch-mul-div-vendor-ip-__codelineno-0-16"></a><span class="w">    </span><span class="p">.</span><span class="n">m_axis_dout_tvalid</span><span class="w">    </span><span class="p">(</span><span class="n">div_out_valid</span><span class="p">),</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#uarch-mul-div-vendor-ip-__codelineno-0-17"></a><span class="w">    </span><span class="p">.</span><span class="n">m_axis_dout_tdata</span><span class="w">     </span><span class="p">(</span><span class="n">div_dout</span><span class="p">)</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#uarch-mul-div-vendor-ip-__codelineno-0-18"></a><span class="p">);</span>
</span></code></pre></div></section></section></section><section class="print-page" id="sim-simulation" heading-number="3"><h1 id="sim-simulation-verification-simulation">Verification &amp; Simulation<a class="headerlink" href="#sim-simulation-verification-simulation" title="Permanent link">&para;</a></h1>
<p>This section outlines the verification strategy for the Hydra-V processor, including unit testing and full system simulation.</p>
<h2 id="sim-simulation-simulation-directory-structure">Simulation Directory Structure<a class="headerlink" href="#sim-simulation-simulation-directory-structure" title="Permanent link">&para;</a></h2>
<p>The <code>sim/</code> directory contains all testbench and verification artifacts:</p>
<ul>
<li><strong><code>sim/tb/</code></strong>: Verilog testbenches for individual modules (ALU, RegFile) and the top-level core.</li>
<li><strong><code>sim/hex/</code></strong>: Pre-compiled hexadecimal files (machine code) loaded into instruction memory for simulation.</li>
</ul>
<h2 id="sim-simulation-prerequisites">Prerequisites<a class="headerlink" href="#sim-simulation-prerequisites" title="Permanent link">&para;</a></h2>
<p>Ensure you have the following tools installed:</p>
<ol>
<li><strong>Xilinx Vivado</strong> (for Behavioral Simulation)</li>
<li><strong>Verilator</strong> (Optional, for faster C++ based simulation)</li>
<li><strong>GTKWave</strong> (for viewing waveform dumps outside Vivado)</li>
</ol>
<h2 id="sim-simulation-running-simulations">Running Simulations<a class="headerlink" href="#sim-simulation-running-simulations" title="Permanent link">&para;</a></h2>
<h3 id="sim-simulation-unit-level-testing">Unit Level Testing<a class="headerlink" href="#sim-simulation-unit-level-testing" title="Permanent link">&para;</a></h3>
<p>Unit tests verify specific components before integration.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#sim-simulation-__codelineno-0-1"></a><span class="c1"># Example: Running the ALU testbench</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#sim-simulation-__codelineno-0-2"></a><span class="nb">cd</span><span class="w"> </span>sim/tb
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#sim-simulation-__codelineno-0-3"></a>xvlog<span class="w"> </span>alu.v<span class="w"> </span>alu_tb.v
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#sim-simulation-__codelineno-0-4"></a>xelab<span class="w"> </span>-debug<span class="w"> </span>typical<span class="w"> </span>alu_tb<span class="w"> </span>-s<span class="w"> </span>alu_sim
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#sim-simulation-__codelineno-0-5"></a>xsim<span class="w"> </span>alu_sim<span class="w"> </span>-R
</span></code></pre></div>
<h3 id="sim-simulation-top-level-system-test">Top Level System Test<a class="headerlink" href="#sim-simulation-top-level-system-test" title="Permanent link">&para;</a></h3>
<p>To verify the full processor pipeline:</p>
<ol>
<li>Load a program hex file into <code>sim/hex/main.hex</code>.</li>
<li>Run the top-level testbench <code>tb_core.v</code>.</li>
<li>Observe the <code>d_mem</code> and register file changes.</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Debugging with Waveforms</p>
<p>If the processor stalls, check the stall_signal and flush lines in the Waveform viewer. A permanent high signal usually indicates a lockup in the Hazard Unit.</p>
</div></section>
                    <section class='print-page md-section' id='section-4' heading-number='4'>
                        <h1>Software<a class='headerlink' href='#section-4' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="sw" heading-number="4.1"><h1 id="sw-software-development-guide">Software Development Guide<a class="headerlink" href="#sw-software-development-guide" title="Permanent link">&para;</a></h1>
<p>This guide explains how to write, compile, and run different software on the Hydra-V processor.</p>
<h2 id="sw-software-directory-structure">Software Directory Structure<a class="headerlink" href="#sw-software-directory-structure" title="Permanent link">&para;</a></h2>
<p>The <code>sw/</code> directory is organized by application. For example:</p>
<ul>
<li><code>sw/coremark/</code> contains the CoreMark benchmark source code and build scripts.</li>
</ul>
<h2 id="sw-system-memory-map">System Memory Map<a class="headerlink" href="#sw-system-memory-map" title="Permanent link">&para;</a></h2>
<p>Followed by the convention set in <a href="https://nus-cg3207.github.io/labs/rv_resources/rv_memmap/">NUS CG3207</a>, the Hydra-V processor uses a memory-mapped I/O architecture. The address space is divided into Instruction Memory, Data Memory, and Peripheral (MMIO) regions.</p>
<div class="admonition info">
<p class="admonition-title">Configuration Source</p>
<p>The memory capacities defined below are determined by parameters in <code>Wrapper.v</code>. For example,
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#sw-__codelineno-0-1"></a><span class="k">localparam</span><span class="w"> </span><span class="n">IROM_DEPTH_BITS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">15</span><span class="p">;</span><span class="w">     </span><span class="c1">// for 2^15 words = 32KB</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#sw-__codelineno-0-2"></a><span class="k">localparam</span><span class="w"> </span><span class="n">DMEM_DEPTH_BITS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">14</span><span class="p">;</span><span class="w">     </span><span class="c1">// for 2^14 words = 16KB</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#sw-__codelineno-0-3"></a><span class="k">localparam</span><span class="w"> </span><span class="n">MMIO_DEPTH_BITS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8</span><span class="p">;</span><span class="w">      </span><span class="c1">// for 2^8 words = 1KB</span>
</span></code></pre></div></p>
<p>If you modify these parameters in <code>Wrapper.v</code>, you must update your linker script and stack initialization accordingly.</p>
</div>
<h3 id="sw-main-memory">Main Memory<a class="headerlink" href="#sw-main-memory" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Address Range</th>
<th>Name</th>
<th>Permissions</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0x00400000  0x00407FFF</code></td>
<td>IROM (Instruction Memory)</td>
<td>RO (Read-Only)</td>
<td>Capacity: 8,192 words (32 KB). Based on <code>IROM_DEPTH_BITS = 15</code>.</td>
</tr>
<tr>
<td><code>0x10010000  0x10013FFF</code></td>
<td>DMEM (Data Memory)</td>
<td>RW (Read-Write)</td>
<td>Capacity: 4,096 words (16 KB). Used for storing constants and variables. Based on <code>DMEM_DEPTH_BITS = 14</code>.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Addressing Constraints</p>
<p>Accesses must be aligned to 4-byte boundaries.</p>
</div>
<h3 id="sw-memory-mapped-peripherals-mmio">Memory-Mapped Peripherals (MMIO)<a class="headerlink" href="#sw-memory-mapped-peripherals-mmio" title="Permanent link">&para;</a></h3>
<p>All peripherals are mapped to the upper memory range starting at <code>0xFFFFxxxx</code>.</p>
<h4 id="sw-communication-uart">Communication (UART)<a class="headerlink" href="#sw-communication-uart" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Address</th>
<th>Register Name</th>
<th>Perms</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0xFFFF0000</code></td>
<td>UART_RX_VALID</td>
<td>RO</td>
<td>Receive Status. Data is valid to read from <code>UART_RX</code> only when the LSB (Least Significant Bit) of this register is set to 1.</td>
</tr>
<tr>
<td><code>0xFFFF0004</code></td>
<td>UART_RX</td>
<td>RO</td>
<td>Receive Data. Reads input from the keyboard. Only the LSByte (lowest 8 bits) contains valid data.</td>
</tr>
<tr>
<td><code>0xFFFF0008</code></td>
<td>UART_TX_READY</td>
<td>RO</td>
<td>Transmit Status. Data is safe to write to <code>UART_TX</code> only when the LSB of this register is set to 1.</td>
</tr>
<tr>
<td><code>0xFFFF000C</code></td>
<td>UART_TX</td>
<td>WO</td>
<td>Transmit Data. Sends output to the display/console. Only the LSByte is writeable.</td>
</tr>
</tbody>
</table>
<h4 id="sw-on-board-io-gpio">On-Board I/O (GPIO)<a class="headerlink" href="#sw-on-board-io-gpio" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Address</th>
<th>Register Name</th>
<th>Perms</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0xFFFF0060</code></td>
<td>LED</td>
<td>WO</td>
<td>LED control register</td>
</tr>
<tr>
<td><code>0xFFFF0064</code></td>
<td>DIP</td>
<td>RO</td>
<td>DIP switch input register</td>
</tr>
<tr>
<td><code>0xFFFF0068</code></td>
<td>PB</td>
<td>RO</td>
<td>Push button input register</td>
</tr>
<tr>
<td><code>0xFFFF0080</code></td>
<td>SEVENSEG</td>
<td>WO</td>
<td>7-segment display output register</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Register Details</p>
<dl>
<dt><code>LED -- 0xFFFF0060 (WO)</code></dt>
<dd>
<p>The lower <strong>8 bits</strong> are user-writeable. The upper bits are hardwired as follows:</p>
<ul>
<li><strong>[7:0]</strong> user writeable,</li>
<li><strong>[8]</strong> divided clock,</li>
<li><strong>[15:9]</strong> program counter <code>[8:2]</code>.</li>
</ul>
</dd>
<dt><code>DIP -- 0xFFFF0064 (RO)</code></dt>
<dd>
<p>Reads the state of the <strong>16 on-board switches</strong>, covering switch range <strong>SW15SW0</strong>.</p>
</dd>
<dt><code>PB -- 0xFFFF0068 (RO)</code></dt>
<dd>
<p>Only the lowest <strong>3 bits</strong> are valid.</p>
<ul>
<li><strong>[2]</strong> BTNR (Right),</li>
<li><strong>[1]</strong> BTNC (Center),</li>
<li><strong>[0]</strong> BTNL (Left).</li>
</ul>
<p>The remaining buttons are hardwired: <strong>BTND</strong> resets the system, while <strong>BTNU</strong> pauses execution.</p>
</dd>
<dt><code>SEVENSEG -- 0xFFFF0080 (WO)</code></dt>
<dd>
<p>Writes an <strong>8-digit hexadecimal number</strong> to the 7-segment display.</p>
</dd>
</dl>
</div>
<h4 id="sw-sensor-display-modules">Sensor &amp; Display Modules<a class="headerlink" href="#sw-sensor-display-modules" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Address</th>
<th>Register Name</th>
<th>Perms</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0xFFFF0020</code></td>
<td>OLED_COL</td>
<td>WO</td>
<td>Sets the OLED pixel column index (0  95).</td>
</tr>
<tr>
<td><code>0xFFFF0024</code></td>
<td>OLED_ROW</td>
<td>WO</td>
<td>Sets the OLED pixel row index (0  63).</td>
</tr>
<tr>
<td><code>0xFFFF0028</code></td>
<td>OLED_DATA</td>
<td>WO</td>
<td>Writes data to the pixel. Format depends on <code>OLED_CTRL</code>.</td>
</tr>
<tr>
<td><code>0xFFFF002C</code></td>
<td>OLED_CTRL</td>
<td>WO</td>
<td>Controls OLED data format and operation modes.</td>
</tr>
<tr>
<td><code>0xFFFF0040</code></td>
<td>ACCEL_DATA</td>
<td>RO</td>
<td>Reads accelerometer data (refer to peripherals documentation for format).</td>
</tr>
<tr>
<td><code>0xFFFF0044</code></td>
<td>ACCEL_DREADY</td>
<td>RO</td>
<td>Data Ready. LSB is set when a new reading is available.</td>
</tr>
</tbody>
</table>
<h4 id="sw-system-counters">System Counters<a class="headerlink" href="#sw-system-counters" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Address</th>
<th>Register Name</th>
<th>Perms</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0xFFFF00A0</code></td>
<td>CYCLECOUNT</td>
<td>RO</td>
<td>Returns the number of clock cycles elapsed since system reset.</td>
</tr>
</tbody>
</table>
<h2 id="sw-toolchain-setup">Toolchain Setup<a class="headerlink" href="#sw-toolchain-setup" title="Permanent link">&para;</a></h2>
<p>I used the RISC-V GNU Toolchain to compile C code into machine code (hex files) and then load them into the Hydra-V processor's IROM (<code>AA_IROM.mem</code>) and DMEM (<code>AA_DMEM.mem</code>).</p>
<h3 id="sw-install-toolchain">Install Toolchain<a class="headerlink" href="#sw-install-toolchain" title="Permanent link">&para;</a></h3>
<p>The toolchain that I used is pre-built and can be found on <a href="https://github.com/stnolting/riscv-gcc-prebuilt">GitHub</a>. I chose the <code>rv32i-131023</code> version. The installation guide is also available on the <a href="https://github.com/stnolting/riscv-gcc-prebuilt?tab=readme-ov-file#installation">repository</a>.</p>
<h3 id="sw-build-configuration">Build Configuration<a class="headerlink" href="#sw-build-configuration" title="Permanent link">&para;</a></h3>
<p>To compile C code into hex files for IROM and DMEM, I used three files: <code>Makefile</code>, <code>ld.script</code> and <code>crt.s</code>. For every C program that is newly written, these three files need to be added and modified accordingly.</p>
<h4 id="sw-makefile"><code>Makefile</code><a class="headerlink" href="#sw-makefile" title="Permanent link">&para;</a></h4>
<p><code>Makefile</code> defines the rules for the <code>make</code> command to work. Make sure the <code>GCC_DIR</code> is correct and feel free to change the <code>CFLAGS</code> as you wish (like changing the Optimization flag from <code>-O2</code> to <code>-O3</code> etc).</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>You can get a template from any one of the application, but I recommend the <a href="https://github.com/mendax1234/Hydra-V/blob/main/sw/calculator/Makefile"><code>sw/calculator/Makefile</code></a>.</p>
</div>
<h4 id="sw-ldscript"><code>ld.script</code><a class="headerlink" href="#sw-ldscript" title="Permanent link">&para;</a></h4>
<p><code>ld.script</code> first specifies the size left for IROM and DMEM. In the Hydra-V processor,</p>
<ul>
<li><code>ROM</code> stands for IROM, its <code>ORIGIN</code> is <code>0x00400000</code>, its <code>LENGTH</code> depends on the size of the <code>code.hex</code> generated.</li>
<li><code>RAM</code> stands for DMEM, its <code>ORIGIN</code> is <code>0x10010000</code>, its <code>LENGTH</code> depends on the size of the <code>data.hex</code> generated.</li>
</ul>
<p>Secondly, it specifies which section in the compiled program goes to which memory region. This determines which part of the program is stored in IROM and which part is stored in DMEM. For example,</p>
<ul>
<li>the <code>.rodata</code> and <code>.data</code> sections are dumped into DMEM</li>
<li>the <code>.text</code> section is dumped into IROM.</li>
</ul>
<h4 id="sw-crts"><code>crt.s</code><a class="headerlink" href="#sw-crts" title="Permanent link">&para;</a></h4>
<p>The <code>crt.s</code> file is the entry point of the software. It sets up the execution environment before handing control to the C <code>main()</code> function.</p>
<p>For each new application, the <code>li sp, &lt;address&gt;</code> instruction needs to be modified to set the stack pointer (<code>sp</code>) to the top of DMEM. The stack grows downwards from high memory to low memory. Thus you should set the stack pointer to the very end of your available DMEM.</p>
<div class="arithmatex">\[
\text{Initial SP} = \text{DMEM_BASE} + \text{DMEM_SIZE}
\]</div>
<p>For example, if your DMEM size is 7KB (the <code>sw/coremark</code> example), and the Hydra-V processor's DMEM base address is <code>0x10010000</code>, then the initial stack pointer should be set to:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#sw-__codelineno-1-1"></a>li sp, 0x10011C00  # 0x10010000 + 7 * 1024
</span></code></pre></div>
<h3 id="sw-compile-and-load">Compile and Load<a class="headerlink" href="#sw-compile-and-load" title="Permanent link">&para;</a></h3>
<p>After setting up the three files above, you can simply run the <code>make</code> command in the terminal while being in the application's directory. If everything is set up correctly, two hex files named <code>code.hex</code> and <code>data.hex</code> will be generated. Copy and paste the contents of <code>code.hex</code> into <code>AA_IROM.mem</code> and <code>data.hex</code> into <code>AA_DMEM.mem</code> in the Vivado project to load the program into the Hydra-V processor.</p>
<p>To clean up the generated files, you can run <code>make clean</code>.</p>
<div class="admonition success">
<p class="admonition-title">Success</p>
<p>Now you are ready to write, compile, and run your software on the Hydra-V processor! Feel free to move on to explore the existing software applications in the <code>sw/</code> directory.</p>
</div></section><section class="print-page" id="sw-benchmark" heading-number="4.2"><h1 id="sw-benchmark-coremark-benchmark">CoreMark Benchmark<a class="headerlink" href="#sw-benchmark-coremark-benchmark" title="Permanent link">&para;</a></h1>
<p>The <a href="https://www.eembc.org/coremark/">CoreMark</a> benchmark is used to evaluate the performance of the Hydra-V processor. It measures the CPU's ability to handle list processing, matrix manipulation, and state machine execution.</p>
<h2 id="sw-benchmark-source-code-organization">Source Code Organization<a class="headerlink" href="#sw-benchmark-source-code-organization" title="Permanent link">&para;</a></h2>
<p>The CoreMark source code and build scripts are located in the <code>sw/coremark/</code> directory.</p>
<h2 id="sw-benchmark-porting-implementation">Porting Implementation<a class="headerlink" href="#sw-benchmark-porting-implementation" title="Permanent link">&para;</a></h2>
<p>The CoreMark port for Hydra-V is based on the barebones implementation. To adapt it for the Hydra-V memory map, modifications are required in <code>sw/coremark/barebones/core_portme.c</code> and <code>sw/coremark/barebones/ee_printf.c</code>.</p>
<h3 id="sw-benchmark-system-timer">System Timer<a class="headerlink" href="#sw-benchmark-system-timer" title="Permanent link">&para;</a></h3>
<p>CoreMark requires a method to measure time to calculate the performance score. In <code>core_portme.c</code>, the <code>barebones_clock()</code> function is modified to read the Hydra-V <code>CYCLECOUNT</code> system counter.</p>
<p><strong>Modification:</strong> Update <code>hardwareCounterAddr</code> to point to the Hydra-V <a href="#sw-system-counters">system counter</a> address (<code>0xFFFF00A0</code>).</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#sw-benchmark-__codelineno-0-1"></a><span class="n">CORETIMETYPE</span><span class="w"> </span><span class="nf">barebones_clock</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#sw-benchmark-__codelineno-0-2"></a><span class="w">    </span><span class="c1">// Pointer to the Hydra-V System Counter (CYCLECOUNT)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#sw-benchmark-__codelineno-0-3"></a><span class="w">    </span><span class="k">volatile</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">hardwareCounterAddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="mh">0xffff00a0</span><span class="p">;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#sw-benchmark-__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#sw-benchmark-__codelineno-0-5"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">hardwareCounter</span><span class="p">;</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#sw-benchmark-__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#sw-benchmark-__codelineno-0-7"></a><span class="w">    </span><span class="c1">// Read hardwareCounter (Execution Cycle)</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#sw-benchmark-__codelineno-0-8"></a><span class="w">    </span><span class="n">hardwareCounter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">hardwareCounterAddr</span><span class="p">;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#sw-benchmark-__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#sw-benchmark-__codelineno-0-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">CORETIMETYPE</span><span class="p">)</span><span class="n">hardwareCounter</span><span class="p">;</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#sw-benchmark-__codelineno-0-11"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="sw-benchmark-uart-output">UART Output<a class="headerlink" href="#sw-benchmark-uart-output" title="Permanent link">&para;</a></h3>
<p>To output the benchmark results to the console, the UART transmission function must be mapped to the correct MMIO addresses.</p>
<p><strong>Modification:</strong> In <code>ee_printf.c</code>, update the pointers in <code>uart_send_char()</code> to match the Hydra-V UART peripheral addresses. The relevant addresses are introduced in <a href="#sw-communication-uart">System Memory Map</a>.</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#sw-benchmark-__codelineno-1-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">uart_send_char</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#sw-benchmark-__codelineno-1-2"></a><span class="w">    </span><span class="k">volatile</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">UART_TX_READY_ADDR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="mh">0xFFFF0008</span><span class="p">;</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#sw-benchmark-__codelineno-1-3"></a><span class="w">    </span><span class="k">volatile</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">UART_TX_ADDR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="mh">0xFFFF000C</span><span class="p">;</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#sw-benchmark-__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#sw-benchmark-__codelineno-1-5"></a><span class="w">    </span><span class="c1">// Wait until UART is ready (LSB == 1 indicates ready)</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#sw-benchmark-__codelineno-1-6"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="o">*</span><span class="n">UART_TX_READY_ADDR</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#sw-benchmark-__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#sw-benchmark-__codelineno-1-8"></a><span class="w">    </span><span class="c1">// Write character to the transmission buffer</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#sw-benchmark-__codelineno-1-9"></a><span class="w">    </span><span class="o">*</span><span class="n">UART_TX_ADDR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#sw-benchmark-__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#sw-benchmark-__codelineno-1-11"></a><span class="w">    </span><span class="c1">// Optional: Wait for transmission completion</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#sw-benchmark-__codelineno-1-12"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="o">*</span><span class="n">UART_TX_READY_ADDR</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#sw-benchmark-__codelineno-1-13"></a><span class="p">}</span>
</span></code></pre></div>
<h2 id="sw-benchmark-build-configuration">Build Configuration<a class="headerlink" href="#sw-benchmark-build-configuration" title="Permanent link">&para;</a></h2>
<h3 id="sw-benchmark-setting-clock-frequency">Setting Clock Frequency<a class="headerlink" href="#sw-benchmark-setting-clock-frequency" title="Permanent link">&para;</a></h3>
<p>To ensure the CoreMark score (Iterations/Sec) is calculated correctly, the build script must know the target processor frequency.</p>
<p>Modify the <code>Makefile</code> under <code>sw/coremark</code> to set the <code>CLOCKS_PER_SEC</code> flag. This value must match the frequency of the Hydra-V processor. For example, for a design running at 50 MHz:</p>
<div class="language-makefile highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#sw-benchmark-__codelineno-2-1"></a><span class="nv">CLOCKS_PER_SEC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50000000</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If <code>CLOCKS_PER_SEC</code> does not match the actual hardware clock frequency, the reported CoreMark/MHz score will be mathematically incorrect.</p>
</div>
<div class="admonition success">
<p class="admonition-title">Ready to Run</p>
<p>With the porting layer configured and the frequency set, the CoreMark benchmark is ready to run on Hydra-V!</p>
</div></section><section class="print-page" id="sw-uart_calculator" heading-number="4.3"><h1 id="sw-uart_calculator-uart-calculator">UART Calculator<a class="headerlink" href="#sw-uart_calculator-uart-calculator" title="Permanent link">&para;</a></h1>
<p>This is a simple calculator program that is used to test the basic functionality of the Hydra-V processor. It contains all the basic instructiosn from RISC-V I and M extensions, and performs arithmetic operations based on user input via UART.</p>
<h2 id="sw-uart_calculator-source-code-organization">Source Code Organization<a class="headerlink" href="#sw-uart_calculator-source-code-organization" title="Permanent link">&para;</a></h2>
<p>The source code for the UART Calculator is located in the <code>sw/uart_calculator/</code> directory. The main source file is <code>uart_calculator.c</code>, which contains the implementation of the calculator logic and UART communication.</p>
<h2 id="sw-uart_calculator-porting-implementation">Porting Implementation<a class="headerlink" href="#sw-uart_calculator-porting-implementation" title="Permanent link">&para;</a></h2>
<h3 id="sw-uart_calculator-uart-output">UART Output<a class="headerlink" href="#sw-uart_calculator-uart-output" title="Permanent link">&para;</a></h3>
<p>As the calculator uses UART to communicate with the Hydra-V processor, if the MMIO addresses are changed, the code in <code>uart_calculator.c</code> must be updated accordingly. The MMIO definitions are located at the top of the <code>uart_calculator.c</code> file,</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#sw-uart_calculator-__codelineno-0-1"></a><span class="cp">#define MMIO_BASE 0xFFFF0000</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#sw-uart_calculator-__codelineno-0-2"></a><span class="cp">#define UART_RX_VALID_OFF 0x00</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#sw-uart_calculator-__codelineno-0-3"></a><span class="cp">#define UART_RX_DATA_OFF 0x04</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#sw-uart_calculator-__codelineno-0-4"></a><span class="cp">#define UART_TX_READY_OFF 0x08</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#sw-uart_calculator-__codelineno-0-5"></a><span class="cp">#define UART_TX_DATA_OFF 0x0C</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#sw-uart_calculator-__codelineno-0-6"></a><span class="cp">#define SEVENSEG_OFF 0x80</span>
</span></code></pre></div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>If you are using different MMIO addresses for UART or other peripherals, make sure to update these definitions accordingly.</p>
</div>
<h3 id="sw-uart_calculator-dmem-initialization">DMEM Initialization<a class="headerlink" href="#sw-uart_calculator-dmem-initialization" title="Permanent link">&para;</a></h3>
<p>The application pre-loads data into Data Memory (DMEM) to test Load/Store instructions. This is handled via initialized global arrays in C, which the linker places in the <code>.data</code> section.</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#sw-uart_calculator-__codelineno-1-1"></a><span class="c1">// Pre-loaded test patterns for Load operations</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#sw-uart_calculator-__codelineno-1-2"></a><span class="kt">uint32_t</span><span class="w"> </span><span class="n">test_data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#sw-uart_calculator-__codelineno-1-3"></a><span class="w">    </span><span class="mh">0x12345678</span><span class="p">,</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#sw-uart_calculator-__codelineno-1-4"></a><span class="w">    </span><span class="mh">0x9ABCDEF0</span><span class="p">,</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#sw-uart_calculator-__codelineno-1-5"></a><span class="w">    </span><span class="mh">0xAABBCCDD</span><span class="p">,</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#sw-uart_calculator-__codelineno-1-6"></a><span class="w">    </span><span class="mh">0xEEFF0011</span><span class="p">};</span>
</span></code></pre></div>
<h2 id="sw-uart_calculator-build-configuration">Build Configuration<a class="headerlink" href="#sw-uart_calculator-build-configuration" title="Permanent link">&para;</a></h2>
<p>There is nothing much to customize or change in the <code>Makefile</code>, <code>ld.script</code> and <code>crt.s</code> files for this application. This is also why this application can be regarded as a template for other new applications.</p>
<h2 id="sw-uart_calculator-application-usage">Application Usage<a class="headerlink" href="#sw-uart_calculator-application-usage" title="Permanent link">&para;</a></h2>
<p>The calculator operates using a strictly defined 9-byte communication protocol over UART.</p>
<h3 id="sw-uart_calculator-communication-protocol">Communication Protocol<a class="headerlink" href="#sw-uart_calculator-communication-protocol" title="Permanent link">&para;</a></h3>
<p>For every operation, the user must send exactly <strong>9 bytes</strong> to the processor:</p>
<ol>
<li><strong>Command 1(1 Byte)</strong>: An ASCII character selecting the operation (see table below).</li>
<li><strong>Operand 1(4 Bytes)</strong>: The first 32-bit argument, sent Big-Endian (MSB first).</li>
<li><strong>Operand 2(4 Bytes)</strong>: The second 32-bit argument, sent Big-Endian (MSB first).</li>
</ol>
<p><strong>Output</strong>: The result of the operation is written to the <strong>7-segment Display</strong> MMIO address.</p>
<h3 id="sw-uart_calculator-command-reference">Command Reference<a class="headerlink" href="#sw-uart_calculator-command-reference" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Category</th>
<th>Command</th>
<th>ASCII</th>
<th>Operation</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Arithmetic</strong></td>
<td>ADD</td>
<td>a</td>
<td>op1 + op2</td>
<td>32-bit Addition</td>
</tr>
<tr>
<td></td>
<td>SUB</td>
<td>s</td>
<td>op1 - op2</td>
<td>32-bit Subtraction</td>
</tr>
<tr>
<td><strong>Logical</strong></td>
<td>AND</td>
<td>c</td>
<td>op1 &amp; op2</td>
<td>Bitwise AND</td>
</tr>
<tr>
<td></td>
<td>OR</td>
<td>o</td>
<td>op1 | op2</td>
<td>Bitwise OR</td>
</tr>
<tr>
<td></td>
<td>XOR</td>
<td>x</td>
<td>op1 ^ op2</td>
<td>Bitwise XOR</td>
</tr>
<tr>
<td><strong>Shift</strong></td>
<td>SLL</td>
<td>L</td>
<td>op1 &lt;&lt; op2</td>
<td>Shift Left Logical</td>
</tr>
<tr>
<td></td>
<td>SRL</td>
<td>R</td>
<td>op1 &gt;&gt; op2</td>
<td>Shift Right Logical</td>
</tr>
<tr>
<td></td>
<td>SRA</td>
<td>A</td>
<td>op1 &gt;&gt; op2</td>
<td>Shift Right Arithmetic (sign-extended)</td>
</tr>
<tr>
<td><strong>Comparison</strong></td>
<td>SLT</td>
<td>l</td>
<td>op1 &lt; op2</td>
<td>Set if Less Than (Signed)</td>
</tr>
<tr>
<td></td>
<td>SLTU</td>
<td>u</td>
<td>op1 &lt; op2</td>
<td>Set if Less Than (Unsigned)</td>
</tr>
<tr>
<td><strong>Multiply / Div</strong></td>
<td>MUL</td>
<td>m</td>
<td>op1 * op2</td>
<td>Low 32 bits of product</td>
</tr>
<tr>
<td></td>
<td>MULH</td>
<td>H</td>
<td>op1 * op2</td>
<td>High 32 bits (Signed)</td>
</tr>
<tr>
<td></td>
<td>MULHU</td>
<td>h</td>
<td>op1 * op2</td>
<td>High 32 bits (Unsigned)</td>
</tr>
<tr>
<td></td>
<td>DIV</td>
<td>d</td>
<td>op1 / op2</td>
<td>Signed Division</td>
</tr>
<tr>
<td></td>
<td>DIVU</td>
<td>D</td>
<td>op1 / op2</td>
<td>Unsigned Division</td>
</tr>
<tr>
<td></td>
<td>REM</td>
<td>r</td>
<td>op1 % op2</td>
<td>Signed Remainder</td>
</tr>
<tr>
<td></td>
<td>REMU</td>
<td>M</td>
<td>op1 % op2</td>
<td>Unsigned Remainder</td>
</tr>
<tr>
<td><strong>Memory Access</strong></td>
<td>LOAD</td>
<td>1..4</td>
<td>Mem[op1]</td>
<td>Reads from <code>test_data</code>. 1=LB, 2=LBU, 3=LH, 4=LHU</td>
</tr>
<tr>
<td></td>
<td>STORE</td>
<td>5..6</td>
<td>Mem[op1] = op2</td>
<td>Writes to <code>scratch_mem</code>. 5=SB, 6=SH</td>
</tr>
</tbody>
</table></section><section class="print-page" id="sw-resources" heading-number="4.4"><h1 id="sw-resources-resoures-utilities">Resoures &amp; Utilities<a class="headerlink" href="#sw-resources-resoures-utilities" title="Permanent link">&para;</a></h1>
<p>This section contains utility guides and extra information regarding the Hydra-V software stack.</p>
<h2 id="sw-resources-offline-access">Offline Access<a class="headerlink" href="#sw-resources-offline-access" title="Permanent link">&para;</a></h2>
<p>This documentation supports exporting the entire site as a single, consolidated PDF for offline reading. This is powered by the <a href="https://timvink.github.io/mkdocs-print-site-plugin/index.html"><code>mkdocs-print-site-plugin</code></a>.</p>
<h3 id="sw-resources-export-to-pdf">Export to PDF<a class="headerlink" href="#sw-resources-export-to-pdf" title="Permanent link">&para;</a></h3>
<p>Currently, there is no direct download button in the navigation bar. You can generate the PDF manually by following these steps:</p>
<ol>
<li>Access the Print View: Navigate to the consolidated print view by appending <code>print_page/</code> to the base URL of the documentation. For example, go to <code>https://mendax1234.github.io/Hydra-V/print_page/</code>.</li>
<li>Print to PDF: Once the page loads (it may take a moment to render all chapters):<ol>
<li>Open your browser's print dialog (<code>Ctrl + P</code> on Windows/Linux or <code>Cmd + P</code> on macOS).</li>
<li>Set the <strong>Destination</strong> to <strong>"Save as PDF"</strong>.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Formatting</p>
<p>For the best layout, ensure <strong>Background graphics</strong> is checked in your browser's print settings to preserve syntax highlighting and admonition colors.</p>
</div>
<h2 id="sw-resources-useful-links">Useful Links<a class="headerlink" href="#sw-resources-useful-links" title="Permanent link">&para;</a></h2>
<p>The success of Hydra-V cannot be achieved without the help of many open-source projects and resources. Here are some useful links that you may find helpful when working with Hydra-V:</p>
<div class="grid cards">
<ul>
<li>
<p><span class="twemoji lg middle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 16a3 3 0 0 1-3-3c0-1.12.61-2.1 1.5-2.61l9.71-5.62-5.53 9.58c-.5.98-1.51 1.65-2.68 1.65m0-13c1.81 0 3.5.5 4.97 1.32l-2.1 1.21C14 5.19 13 5 12 5a8 8 0 0 0-8 8c0 2.21.89 4.21 2.34 5.65h.01c.39.39.39 1.02 0 1.41s-1.03.39-1.42.01A9.97 9.97 0 0 1 2 13 10 10 0 0 1 12 3m10 10c0 2.76-1.12 5.26-2.93 7.07-.39.38-1.02.38-1.41-.01a.996.996 0 0 1 0-1.41A7.95 7.95 0 0 0 20 13c0-1-.19-2-.54-2.9L20.67 8C21.5 9.5 22 11.18 22 13"/></svg></span> <strong>CoreMark Benchmark</strong></p>
<hr />
<p>Official CoreMark benchmark by EEMBC, widely used to evaluate embedded
processor performance.</p>
<p><a href="https://www.eembc.org/coremark/"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0"/></svg></span> Visit EEMBC</a></p>
</li>
<li>
<p><span class="twemoji lg middle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 4h12v1h3v2h-3v2h3v2h-3v2h3v2h-3v2h3v2h-3v1H6v-1H3v-2h3v-2H3v-2h3v-2H3V9h3V7H3V5h3zm5 11v3h1v-3zm2 0v3h1v-3zm2 0v3h1v-3z"/></svg></span> <strong>CoreMark on Bare-Metal Systems</strong></p>
<hr />
<p>CoreMark running on bare-bone RISC-V systems, including build scripts
and platform-specific adaptations.</p>
<p><a href="https://github.com/yutyan0119/rv32I-TangNano9K/tree/main/Coremark"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0"/></svg></span> View on GitHub</a></p>
</li>
<li>
<p><span class="twemoji lg middle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"/></svg></span> <strong>Pre-built RISC-V GNU Toolchain</strong></p>
<hr />
<p>Pre-compiled RISC-V GCC toolchain for rapid development without
building from source.</p>
<p><a href="https://github.com/stnolting/riscv-gcc-prebuilt"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0"/></svg></span> Download Toolchain</a></p>
</li>
</ul>
</div></section></section></div><style>.print-site-enumerate-headings #index > h1:before { content: '1 ' }

                .print-site-enumerate-headings #index h2:before { content: '1.' counter(counter-index-2) ' ' }
                .print-site-enumerate-headings #index h2 {  counter-reset: counter-index-3 ;  counter-increment: counter-index-2 }
            
                .print-site-enumerate-headings #index h3:before { content: '1.' counter(counter-index-2) '.' counter(counter-index-3) ' ' }
                .print-site-enumerate-headings #index h3 {  counter-increment: counter-index-3 }
            
.print-site-enumerate-headings #section-2 > h1:before { content: '2 ' }
.print-site-enumerate-headings #uarch > h1:before { content: '2.1 ' }

                .print-site-enumerate-headings #uarch h2:before { content: '2.1.' counter(counter-uarch-2) ' ' }
                .print-site-enumerate-headings #uarch h2 {  counter-increment: counter-uarch-2 }
            
.print-site-enumerate-headings #section-2-2 > h1:before { content: '2.2 ' }
.print-site-enumerate-headings #uarch-mul-div > h1:before { content: '2.2.1 ' }

.print-site-enumerate-headings #uarch-mul-div-native-design > h1:before { content: '2.2.2 ' }

.print-site-enumerate-headings #uarch-mul-div-vendor-ip > h1:before { content: '2.2.3 ' }

.print-site-enumerate-headings #sim-simulation > h1:before { content: '3 ' }

                .print-site-enumerate-headings #sim-simulation h2:before { content: '3.' counter(counter-sim-simulation-2) ' ' }
                .print-site-enumerate-headings #sim-simulation h2 {  counter-reset: counter-sim-simulation-3 ;  counter-increment: counter-sim-simulation-2 }
            
                .print-site-enumerate-headings #sim-simulation h3:before { content: '3.' counter(counter-sim-simulation-2) '.' counter(counter-sim-simulation-3) ' ' }
                .print-site-enumerate-headings #sim-simulation h3 {  counter-increment: counter-sim-simulation-3 }
            
.print-site-enumerate-headings #section-4 > h1:before { content: '4 ' }
.print-site-enumerate-headings #sw > h1:before { content: '4.1 ' }

                .print-site-enumerate-headings #sw h2:before { content: '4.1.' counter(counter-sw-2) ' ' }
                .print-site-enumerate-headings #sw h2 {  counter-increment: counter-sw-2 }
            
.print-site-enumerate-headings #sw-benchmark > h1:before { content: '4.2 ' }

                .print-site-enumerate-headings #sw-benchmark h2:before { content: '4.2.' counter(counter-sw-benchmark-2) ' ' }
                .print-site-enumerate-headings #sw-benchmark h2 {  counter-increment: counter-sw-benchmark-2 }
            
.print-site-enumerate-headings #sw-uart_calculator > h1:before { content: '4.3 ' }

                .print-site-enumerate-headings #sw-uart_calculator h2:before { content: '4.3.' counter(counter-sw-uart_calculator-2) ' ' }
                .print-site-enumerate-headings #sw-uart_calculator h2 {  counter-increment: counter-sw-uart_calculator-2 }
            
.print-site-enumerate-headings #sw-resources > h1:before { content: '4.4 ' }

                .print-site-enumerate-headings #sw-resources h2:before { content: '4.4.' counter(counter-sw-resources-2) ' ' }
                .print-site-enumerate-headings #sw-resources h2 {  counter-increment: counter-sw-resources-2 }
            </style>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "/Hydra-V/", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "navigation.footer", "navigation.path", "navigation.indexes", "content.code.copy", "content.action.edit"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../js/timeago.min.js"></script>
      
        <script src="../js/timeago_mkdocs_material.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>