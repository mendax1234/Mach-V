
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mendax1234.github.io/Hydra-V/dev/print_page/">
      
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Print Site - Hydra-V Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../css/timeago.css">
    
    <script>__md_scope=new URL("/Hydra-V/dev",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#index" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Hydra-V Docs" class="md-header__button md-logo" aria-label="Hydra-V Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Hydra-V Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/mendax1234/Hydra-V" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mendax1234/Hydra-V
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../microarchitecture/" class="md-tabs__link">
          
  
  
    
  
  Microarchitecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../sim/simulation/" class="md-tabs__link">
        
  
  
    
  
  Simulation

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../sw/benchmark/" class="md-tabs__link">
          
  
  
    
  
  Software

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Hydra-V Docs" class="md-nav__button md-logo" aria-label="Hydra-V Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Hydra-V Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mendax1234/Hydra-V" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mendax1234/Hydra-V
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../microarchitecture/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Microarchitecture
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Microarchitecture
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../microarchitecture/mul-div/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Multiply & Divide Unit
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Multiply & Divide Unit
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../microarchitecture/mul-div/native-design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Native Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../microarchitecture/mul-div/vendor-ip/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Xilinix IP Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sim/simulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simulation
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Software
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Software
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sw/benchmark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Benchmark
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sw/uart_calculator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UART Calculator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sw/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    <span class="md-ellipsis">
      
        1 Home
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2 Microarchitecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 Microarchitecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microarchitecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Microarchitecture of Hydra-V Processor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-2-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Multiply & Divide Unit
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2 Multiply &amp; Divide Unit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microarchitecture-mul-div" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.1 Multiply &amp; Divide Unit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microarchitecture-mul-div-native-design" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.2 Native Design
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microarchitecture-mul-div-vendor-ip" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.3 Xilinix IP Design
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sim-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        3 Simulation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-4" class="md-nav__link">
    <span class="md-ellipsis">
      
        4 Software
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4 Software">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sw-benchmark" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Benchmark
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sw-uart_calculator" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 UART Calculator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sw-contributing" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3 Contributing
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


              
              <article class="md-content__inner md-typeset">
                
                  



<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index" heading-number="1"><h1 id="index-hydra-v-processor">Hydra-V Processor<a class="headerlink" href="#index-hydra-v-processor" title="Permanent link">&para;</a></h1>
<p>Welcome to the documentation for <strong>Hydra-V</strong>, a custom RISC-V processor implementation targeting the Nexys 4 DDR FPGA.</p>
<h2 id="index-key-features">Key Features<a class="headerlink" href="#index-key-features" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>ISA</strong>: RISC-V RV32I Base Integer Instruction Set</li>
<li><strong>Pipeline</strong>: 5-Stage Classic (Fetch, Decode, Execute, Memory, Writeback)</li>
<li><strong>Hazard Handling</strong>: Full Forwarding Unit + Stall Logic</li>
<li><strong>Peripherals</strong>: UART, GPIO, Seven-Segment Display</li>
</ul>
<h2 id="index-quick-start">Quick Start<a class="headerlink" href="#index-quick-start" title="Permanent link">&para;</a></h2>
<p>Check out the <a href="#sw-software.md">User Guide</a> to run your first program, or view the <a href="#sim-simulation">Verification</a> section to run the testbench.</p></section>
                    <section class='print-page md-section' id='section-2' heading-number='2'>
                        <h1>Microarchitecture<a class='headerlink' href='#section-2' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="microarchitecture" heading-number="2.1"><h1 id="microarchitecture-microarchitecture-of-hydra-v-processor">Microarchitecture of Hydra-V Processor<a class="headerlink" href="#microarchitecture-microarchitecture-of-hydra-v-processor" title="Permanent link">&para;</a></h1>
<p>The microarchitecture of Hydra-V is shown in the figure below:</p>
<p><img alt="System Architecture" src="../assets/images/Hydra-V-0.1.svg" /></p></section>
                    <section class='print-page md-section' id='section-2-2' heading-number='2.2'>
                        <h1>Multiply & Divide Unit<a class='headerlink' href='#section-2-2' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="microarchitecture-mul-div" heading-number="2.2.1"><h1 id="microarchitecture-mul-div-multiply-divide-unit">Multiply &amp; Divide Unit<a class="headerlink" href="#microarchitecture-mul-div-multiply-divide-unit" title="Permanent link">&para;</a></h1>
<p>In this version of the Hydra-V processor, the multiply and divide unit is incorporated into one file called <code>MCycle.v</code>. The whole idea of the <code>MCycle</code> module is that, while it is doing the computation, the <code>Busy</code> signal (output) will be triggered high and this signal will be used to stall the other relevant pipeline registers so that no new instructions are fetched until the multiplication/division is complete.</p>
<p>This module is implemented using the mealy state machine.</p>
<h2 id="microarchitecture-mul-div-state-machine-control">State Machine Control<a class="headerlink" href="#microarchitecture-mul-div-state-machine-control" title="Permanent link">&para;</a></h2>
<h2 id="microarchitecture-mul-div-implementation-details">Implementation Details<a class="headerlink" href="#microarchitecture-mul-div-implementation-details" title="Permanent link">&para;</a></h2>
<p>I have tried two implementations for the <code>MCycle</code> module:</p>
<div class="grid cards">
<ul>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 4h10c1.11 0 2 .89 2 2v2h-3.41L16 10.59v4l-2 2V20h-4v-3.41l-2-2V9.41l2-2zm8 7.41V14h4v-4h-2.59zM6.59 8 8 6.59V4H4c-1.11 0-2 .89-2 2v2zM6 14v-4H2v4zm2 3.41L6.59 16H2v2c0 1.11.89 2 2 2h4zM17.41 16 16 17.41V20h4c1.11 0 2-.89 2-2v-2z"/></svg></span> <strong>Native Design</strong></p>
<hr />
<p>Implement the multiply and divide unit by "hand-typped" Verilog code.</p>
<p><a href="#microarchitecture-mul-div-native-design"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0"/></svg></span> View Documentation</a></p>
</li>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.123 24q-.303 0-.603-.017a.5.5 0 0 1-.043-.287.7.7 0 0 0-.022-.263h-2.23a1.2 1.2 0 0 1-.785.39.7.7 0 0 1-.507-.228.915.915 0 0 1-.065-1.1.7.7 0 0 1 .557-.266 1.22 1.22 0 0 1 .703.267h2.328a2 2 0 0 0 0-.614H10.26a1.14 1.14 0 0 1-.55-.13 22 22 0 0 0-1.487-.808 1.4 1.4 0 0 0-.71-.194 7 7 0 0 1-.476.015q-.236-.001-.464-.007a19 19 0 0 0-.45-.008 1.35 1.35 0 0 1-.814.37.68.68 0 0 1-.512-.24.76.76 0 0 1 0-1.067.72.72 0 0 1 .537-.272 1.3 1.3 0 0 1 .756.337h1.681a1.14 1.14 0 0 1 .55.129c.14.082.293.162.441.239a6 6 0 0 1 .754.44 1.95 1.95 0 0 0 1.116.33 3 3 0 0 0 .178-.007 2 2 0 0 1 .219-.014q.101 0 .208.007c.08.004.161.007.251.007v-1.034h-1.164a1.27 1.27 0 0 1-.71.3.84.84 0 0 1-.615-.332c-.37-.404-.134-.803.13-1.067a.56.56 0 0 1 .353-.125 1.35 1.35 0 0 1 .842.448h1.1v-.905a.4.4 0 0 0-.178-.04q-.04 0-.083.004-.044.003-.095.004H4.959a.84.84 0 0 1-.743-.356c-.172-.228-.37-.459-.545-.663l-.07-.08c-.743-.065-.97-.285-.937-.905a.75.75 0 0 1 .84-.679c.492 0 .711.33.711 1.067q.09.105.183.22c.136.164.276.335.432.491h6.658a5.5 5.5 0 0 0 0-1.034H6.64a1.32 1.32 0 0 1-.795.37.66.66 0 0 1-.498-.24.746.746 0 0 1 0-1.1.7.7 0 0 1 .508-.268 1.17 1.17 0 0 1 .72.365h4.88v-1.002H3.215q-.234.259-.502.535c-.158.166-.321.337-.5.531a.84.84 0 0 1-.792.752 1 1 0 0 1-.114-.008.846.846 0 0 1-.646-1.002c.059-.383.372-.602.86-.602a2 2 0 0 1 .271.02c.177-.206.444-.508.711-.776a.96.96 0 0 1 .776-.323h8.177v-1.099H1.63a1.23 1.23 0 0 1-.744.344.68.68 0 0 1-.55-.312.85.85 0 0 1 .098-1.13.75.75 0 0 1 .479-.195 1.15 1.15 0 0 1 .814.485h3.2l-.102-.097c-.56-.528-1.138-1.075-1.838-1.713a.755.755 0 0 1-.776-.808c0-.514.22-.743.711-.743.662 0 .84.212.873 1.034.248.238.492.469.75.713.543.513 1.102 1.042 1.674 1.614h5.236v-.743H9.161a1.28 1.28 0 0 1-.705.263.75.75 0 0 1-.588-.296.81.81 0 0 1 .129-1.098.64.64 0 0 1 .437-.168 1.28 1.28 0 0 1 .824.394h2.198v-.84q-.342-.001-.671-.008h-.007a39 39 0 0 0-.656-.007c-.248 0-.467.005-.67.014a1 1 0 0 1-.115.005 1.23 1.23 0 0 1-.855-.36l-.6-.507-.012-.01-.008-.007A261 261 0 0 0 6.64 7.272H3.052a1.24 1.24 0 0 1-.72.29.73.73 0 0 1-.573-.29.776.776 0 0 1 .097-1.099.7.7 0 0 1 .474-.223 1.36 1.36 0 0 1 .819.45h3.135a1.6 1.6 0 0 1 1.164.452c.373.351.795.69 1.203 1.019h.001c.19.153.388.311.573.466h2.198V7.271c-.138 0-.282-.004-.42-.007H11a18 18 0 0 0-.44-.008q-.24 0-.428.015a1 1 0 0 1-.115.005 1.34 1.34 0 0 1-.856-.327 11 11 0 0 0-.305-.24c-.103-.08-.212-.162-.31-.245-.8-.064-1.098-.29-1.066-.808a.776.776 0 0 1 .776-.743c.497 0 .775.302.808.872.129.097.258.204.388.307l.001.002c.127.103.259.21.388.306h1.584V5.14h-.55a1.35 1.35 0 0 1-.765.36.69.69 0 0 1-.528-.296.8.8 0 0 1 .033-1.1.7.7 0 0 1 .5-.214 1.1 1.1 0 0 1 .759.376h.517a.5.5 0 0 0 .043-.346 1 1 0 0 1-.01-.138v-.517a3 3 0 0 1-.292.012 9 9 0 0 1-.355-.01h-.007a8 8 0 0 0-.364-.01 1.96 1.96 0 0 0-1.018.234 11 11 0 0 1-1.115.582H8.27c-.153.073-.312.148-.466.224a.9.9 0 0 1-.42.065H5.22a1.1 1.1 0 0 1-.696.328.78.78 0 0 1-.598-.327.72.72 0 0 1-.181-.545.85.85 0 0 1 .31-.586.74.74 0 0 1 .473-.197 1.07 1.07 0 0 1 .755.456h2.101a.6.6 0 0 0 .223-.053 1 1 0 0 1 .133-.044q.197-.099.39-.19a10 10 0 0 0 .935-.489 2.56 2.56 0 0 1 1.353-.362q.097 0 .198.006a2 2 0 0 0 .258.014q.127 0 .26-.006h.001q.138-.007.286-.008a2.1 2.1 0 0 0 .037-.59q-.004-.105-.004-.218H9.416a1.46 1.46 0 0 1-.766.332.68.68 0 0 1-.526-.3.83.83 0 0 1 .065-1.098.72.72 0 0 1 .487-.205 1.24 1.24 0 0 1 .776.366h2.004q.002-.133.014-.276c.009-.114.018-.231.018-.37h.126c4.196 0 7.492 1.642 9.797 4.88a12.23 12.23 0 0 1 2.408 6.457c.12 2.203-.44 4.457-1.665 6.698a11.4 11.4 0 0 1-4.433 4.477A11.5 11.5 0 0 1 12.123 24m.367-5.577v4.46a1.6 1.6 0 0 0 .27.022 3.5 3.5 0 0 0 .491-.045c.11-.015.22-.033.337-.041a15 15 0 0 0 2.392-4.396zm4.654 0a19 19 0 0 1-1.842 3.944 10.38 10.38 0 0 0 5.3-3.944zm1.035-5.785a20.5 20.5 0 0 1-.68 4.654h3.815a11.2 11.2 0 0 0 1.293-4.654zm-5.69 0v4.622h3.88a18.2 18.2 0 0 0 .678-4.622zm.033-5.786v4.654h4.557a18.7 18.7 0 0 0-.71-4.654zm4.945-.032a21.4 21.4 0 0 1 .711 4.654h4.428a10.9 10.9 0 0 0-1.325-4.654zM15.27 1.778a20 20 0 0 1 1.875 3.943h3.459a10.6 10.6 0 0 0-5.333-3.943zm-2.747-.582c0 1.562 0 3.038.032 4.493h3.459a.12.12 0 0 1-.032-.097 16.2 16.2 0 0 0-2.23-4.105l-.038-.04a.28.28 0 0 0-.189-.122 10 10 0 0 0-1.002-.13"/></svg></span> <strong>Using IP Cores</strong></p>
<hr />
<p>Use Xilinx IP cores to implement the multiply and divide unit.</p>
<p><a href="#microarchitecture-mul-div-vendor-ip"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0"/></svg></span> View Documentation</a></p>
</li>
</ul>
</div></section><section class="print-page" id="microarchitecture-mul-div-native-design" heading-number="2.2.2"><h1 id="microarchitecture-mul-div-native-design-native-design-of-multiply-divide-unit">Native Design of Multiply &amp; Divide Unit<a class="headerlink" href="#microarchitecture-mul-div-native-design-native-design-of-multiply-divide-unit" title="Permanent link">&para;</a></h1>
<p>This is a follow-up from <a href="https://nus-cg3207.github.io/labs/asst_manuals/Asst_03/Asst_03/">CG3207 Assignment 3</a>. More specifically, it is my try to finish the first bullet point in the <a href="https://nus-cg3207.github.io/labs/asst_manuals/Asst_03/Asst_03/#task-3-enhancements-5-points">Task 3 of this assignment</a>.</p>
<h2 id="microarchitecture-mul-div-native-design-multiply-unit">Multiply Unit<a class="headerlink" href="#microarchitecture-mul-div-native-design-multiply-unit" title="Permanent link">&para;</a></h2>
<p>For the multiply unit, the idea is to "unroll" the loop. For the 32-bit multiplication, instead of using 32 cycles to compute the result by shifting 1 bit a time, I generate the partial products for every 8 bits of the multiplier in parallel. So, the temporal product here will be <span class="arithmatex">\(32+8=40\)</span> bits wide.</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#microarchitecture-mul-div-native-design-__codelineno-0-1"></a><span class="k">module</span><span class="w"> </span><span class="n">Multiplier32x8</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#microarchitecture-mul-div-native-design-__codelineno-0-2"></a><span class="w">    </span><span class="k">input</span><span class="w">  </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w">       </span><span class="c1">// The 32-bit full operand</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#microarchitecture-mul-div-native-design-__codelineno-0-3"></a><span class="w">    </span><span class="k">input</span><span class="w">  </span><span class="p">[</span><span class="w"> </span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w">       </span><span class="c1">// The 8-bit slice</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#microarchitecture-mul-div-native-design-__codelineno-0-4"></a><span class="w">    </span><span class="k">output</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">Product</span><span class="w">  </span><span class="c1">// Result (32 + 8 = 40 bits max)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#microarchitecture-mul-div-native-design-__codelineno-0-5"></a><span class="p">);</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#microarchitecture-mul-div-native-design-__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#microarchitecture-mul-div-native-design-__codelineno-0-7"></a><span class="w">    </span><span class="c1">// // Generate Partial Products (Shift A based on bit position of B)</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#microarchitecture-mul-div-native-design-__codelineno-0-8"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">8</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#microarchitecture-mul-div-native-design-__codelineno-0-9"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">7</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#microarchitecture-mul-div-native-design-__codelineno-0-10"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">6</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#microarchitecture-mul-div-native-design-__codelineno-0-11"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">5</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">3</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#microarchitecture-mul-div-native-design-__codelineno-0-12"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">4</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">4</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#microarchitecture-mul-div-native-design-__codelineno-0-13"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">5</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">3</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">5</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#microarchitecture-mul-div-native-design-__codelineno-0-14"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">6</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">6</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#microarchitecture-mul-div-native-design-__codelineno-0-15"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">7</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">7</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#microarchitecture-mul-div-native-design-__codelineno-0-16"></a>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#microarchitecture-mul-div-native-design-__codelineno-0-17"></a><span class="w">    </span><span class="c1">// Sum them up (Tree adder is faster, but this simple chain works also)</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#microarchitecture-mul-div-native-design-__codelineno-0-18"></a><span class="w">    </span><span class="k">assign</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pp0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp7</span><span class="p">;</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#microarchitecture-mul-div-native-design-__codelineno-0-19"></a>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#microarchitecture-mul-div-native-design-__codelineno-0-20"></a><span class="k">endmodule</span>
</span></code></pre></div>
<p>In this module, the input <code>A</code> is the full 32-bit multiplicand, while <code>B</code> is an 8-bit slice of the multiplier. The output <code>Product</code> is the 40-bit partial product. For the sliced version of the multiplier, it can be implemented as follows in the state machine control:</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#microarchitecture-mul-div-native-design-__codelineno-1-1"></a><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">])</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#microarchitecture-mul-div-native-design-__codelineno-1-2"></a><span class="w">    </span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="o">:</span><span class="w"> </span><span class="n">current_byte_op2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs_op2</span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#microarchitecture-mul-div-native-design-__codelineno-1-3"></a><span class="w">    </span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="o">:</span><span class="w"> </span><span class="n">current_byte_op2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs_op2</span><span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">8</span><span class="p">];</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#microarchitecture-mul-div-native-design-__codelineno-1-4"></a><span class="w">    </span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="o">:</span><span class="w"> </span><span class="n">current_byte_op2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs_op2</span><span class="p">[</span><span class="mh">23</span><span class="o">:</span><span class="mh">16</span><span class="p">];</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#microarchitecture-mul-div-native-design-__codelineno-1-5"></a><span class="w">    </span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="o">:</span><span class="w"> </span><span class="n">current_byte_op2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs_op2</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">24</span><span class="p">];</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#microarchitecture-mul-div-native-design-__codelineno-1-6"></a><span class="k">endcase</span>
</span></code></pre></div>
<p>The final product is then obtained by summing up the 4 partial products with appropriate shifts, which can be implemented as follows:</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#microarchitecture-mul-div-native-design-__codelineno-2-1"></a><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#microarchitecture-mul-div-native-design-__codelineno-2-2"></a><span class="w">    </span><span class="mh">1</span><span class="o">:</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">partial_product_out</span><span class="p">;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#microarchitecture-mul-div-native-design-__codelineno-2-3"></a><span class="w">    </span><span class="mh">2</span><span class="o">:</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">partial_product_out</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mh">8</span><span class="p">);</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#microarchitecture-mul-div-native-design-__codelineno-2-4"></a><span class="w">    </span><span class="mh">3</span><span class="o">:</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">partial_product_out</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mh">16</span><span class="p">);</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#microarchitecture-mul-div-native-design-__codelineno-2-5"></a><span class="w">    </span><span class="mh">4</span><span class="o">:</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mult_acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">partial_product_out</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mh">24</span><span class="p">);</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#microarchitecture-mul-div-native-design-__codelineno-2-6"></a><span class="k">endcase</span>
</span></code></pre></div>
<p>And lastly, this module is instantiated in the <code>MCycle</code> module as follows:</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#microarchitecture-mul-div-native-design-__codelineno-3-1"></a><span class="n">Multiplier32x8</span><span class="w"> </span><span class="n">mul_unit</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#microarchitecture-mul-div-native-design-__codelineno-3-2"></a><span class="w">    </span><span class="p">.</span><span class="n">A</span><span class="w">      </span><span class="p">(</span><span class="n">abs_op1</span><span class="p">),</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#microarchitecture-mul-div-native-design-__codelineno-3-3"></a><span class="w">    </span><span class="p">.</span><span class="n">B</span><span class="w">      </span><span class="p">(</span><span class="n">current_byte_op2</span><span class="p">),</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#microarchitecture-mul-div-native-design-__codelineno-3-4"></a><span class="w">    </span><span class="p">.</span><span class="n">Product</span><span class="p">(</span><span class="n">partial_product_out</span><span class="p">)</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#microarchitecture-mul-div-native-design-__codelineno-3-5"></a><span class="p">);</span>
</span></code></pre></div>
<details class="tip" open="open">
<summary>Tip</summary>
<p>This technique can indeed be implementated using <code>for</code> loop in Verilog as follows:</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#microarchitecture-mul-div-native-design-__codelineno-4-1"></a><span class="k">module</span><span class="w"> </span><span class="n">Multiplier32x8</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#microarchitecture-mul-div-native-design-__codelineno-4-2"></a><span class="w">    </span><span class="k">input</span><span class="w">  </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w">       </span><span class="c1">// The 32-bit full operand</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#microarchitecture-mul-div-native-design-__codelineno-4-3"></a><span class="w">    </span><span class="k">input</span><span class="w">  </span><span class="p">[</span><span class="w"> </span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w">       </span><span class="c1">// The 8-bit slice</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#microarchitecture-mul-div-native-design-__codelineno-4-4"></a><span class="w">    </span><span class="k">output</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">Product</span><span class="w">  </span><span class="c1">// Result (32 + 8 = 40 bits max)</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#microarchitecture-mul-div-native-design-__codelineno-4-5"></a><span class="p">);</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#microarchitecture-mul-div-native-design-__codelineno-4-6"></a>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#microarchitecture-mul-div-native-design-__codelineno-4-7"></a><span class="w">    </span><span class="c1">// // Generate Partial Products (Shift A based on bit position of B)</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#microarchitecture-mul-div-native-design-__codelineno-4-8"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">8</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#microarchitecture-mul-div-native-design-__codelineno-4-9"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">7</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#microarchitecture-mul-div-native-design-__codelineno-4-10"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">6</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#microarchitecture-mul-div-native-design-__codelineno-4-11"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">5</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">3</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#microarchitecture-mul-div-native-design-__codelineno-4-12"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">4</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">4</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#microarchitecture-mul-div-native-design-__codelineno-4-13"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">5</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">3</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">5</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#microarchitecture-mul-div-native-design-__codelineno-4-14"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">6</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">6</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#microarchitecture-mul-div-native-design-__codelineno-4-15"></a><span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">pp7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="mh">7</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mh">7</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">40</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#microarchitecture-mul-div-native-design-__codelineno-4-16"></a>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#microarchitecture-mul-div-native-design-__codelineno-4-17"></a><span class="w">    </span><span class="c1">// Sum them up (Tree adder is faster, but this simple chain works also)</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#microarchitecture-mul-div-native-design-__codelineno-4-18"></a><span class="w">    </span><span class="k">assign</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pp0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pp7</span><span class="p">;</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#microarchitecture-mul-div-native-design-__codelineno-4-19"></a>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#microarchitecture-mul-div-native-design-__codelineno-4-20"></a><span class="k">endmodule</span>
</span></code></pre></div>
<p>This is totally valid. However, the smart synthesizer will generate the same hardware for both implementations.</p>
</details>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The 8 bits design will still use more hardware than I thought, which will give around 13ns propagation delay. This will limit the Hydra-V clock frequency to 50MHz max if the clock wizard is not used!</p>
</div>
<h2 id="microarchitecture-mul-div-native-design-divide-unit">Divide Unit<a class="headerlink" href="#microarchitecture-mul-div-native-design-divide-unit" title="Permanent link">&para;</a></h2>
<p>Similarly, I did the unrolling for the divider unit as well. So, instead of getting at most 1 bit of quotient and remainder per cycle. Now, I can get at most 8 bits of quotient and remainder per cycle. This divider unit is implemented using the <code>for</code> loop in Verilog as follows:</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#microarchitecture-mul-div-native-design-__codelineno-5-1"></a><span class="k">module</span><span class="w"> </span><span class="n">DivSlice8</span><span class="w"> </span><span class="p">#(</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#microarchitecture-mul-div-native-design-__codelineno-5-2"></a><span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">32</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#microarchitecture-mul-div-native-design-__codelineno-5-3"></a><span class="p">)</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#microarchitecture-mul-div-native-design-__codelineno-5-4"></a><span class="w">    </span><span class="k">input</span><span class="w">      </span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">rem_in</span><span class="p">,</span><span class="w">   </span><span class="c1">// Current Remainder</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#microarchitecture-mul-div-native-design-__codelineno-5-5"></a><span class="w">    </span><span class="k">input</span><span class="w">      </span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">div_in</span><span class="p">,</span><span class="w">   </span><span class="c1">// Current Divisor</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#microarchitecture-mul-div-native-design-__codelineno-5-6"></a><span class="w">    </span><span class="k">input</span><span class="w">      </span><span class="p">[</span><span class="w">  </span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">quot_in</span><span class="p">,</span><span class="w">  </span><span class="c1">// Current Quotient (LSW of buffer)</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#microarchitecture-mul-div-native-design-__codelineno-5-7"></a><span class="w">    </span><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">rem_out</span><span class="p">,</span><span class="w">  </span><span class="c1">// Next Remainder</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#microarchitecture-mul-div-native-design-__codelineno-5-8"></a><span class="w">    </span><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">div_out</span><span class="p">,</span><span class="w">  </span><span class="c1">// Next Divisor</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#microarchitecture-mul-div-native-design-__codelineno-5-9"></a><span class="w">    </span><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="w">  </span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">quot_out</span><span class="w">  </span><span class="c1">// Next Quotient</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#microarchitecture-mul-div-native-design-__codelineno-5-10"></a><span class="p">);</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#microarchitecture-mul-div-native-design-__codelineno-5-11"></a>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#microarchitecture-mul-div-native-design-__codelineno-5-12"></a><span class="w">    </span><span class="c1">// Temporary variable for subtraction</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#microarchitecture-mul-div-native-design-__codelineno-5-13"></a><span class="w">    </span><span class="k">integer</span><span class="w">             </span><span class="n">i</span><span class="p">;</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#microarchitecture-mul-div-native-design-__codelineno-5-14"></a><span class="w">    </span><span class="kt">reg</span><span class="w">     </span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="nl">width:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">diff_ext</span><span class="p">;</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#microarchitecture-mul-div-native-design-__codelineno-5-15"></a>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#microarchitecture-mul-div-native-design-__codelineno-5-16"></a><span class="w">    </span><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#microarchitecture-mul-div-native-design-__codelineno-5-17"></a><span class="w">        </span><span class="c1">// Initialize temporary variables with inputs</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#microarchitecture-mul-div-native-design-__codelineno-5-18"></a><span class="w">        </span><span class="n">rem_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rem_in</span><span class="p">;</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#microarchitecture-mul-div-native-design-__codelineno-5-19"></a><span class="w">        </span><span class="n">div_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">div_in</span><span class="p">;</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#microarchitecture-mul-div-native-design-__codelineno-5-20"></a><span class="w">        </span><span class="n">quot_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quot_in</span><span class="p">;</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#microarchitecture-mul-div-native-design-__codelineno-5-21"></a>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#microarchitecture-mul-div-native-design-__codelineno-5-22"></a><span class="w">        </span><span class="c1">// Perform 8 iterations of division logic (Combinational Loop)</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#microarchitecture-mul-div-native-design-__codelineno-5-23"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mh">8</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#microarchitecture-mul-div-native-design-__codelineno-5-24"></a><span class="w">            </span><span class="c1">// 1. Subtract: Remainder - Divisor</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#microarchitecture-mul-div-native-design-__codelineno-5-25"></a><span class="w">            </span><span class="n">diff_ext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">rem_out</span><span class="p">}</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="o">~</span><span class="n">div_out</span><span class="p">}</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#microarchitecture-mul-div-native-design-__codelineno-5-26"></a>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#microarchitecture-mul-div-native-design-__codelineno-5-27"></a><span class="w">            </span><span class="c1">// 2. Check Sign</span>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#microarchitecture-mul-div-native-design-__codelineno-5-28"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">diff_ext</span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#microarchitecture-mul-div-native-design-__codelineno-5-29"></a><span class="w">                </span><span class="c1">// Result Positive: Update Remainder, Shift 1 into Quotient</span>
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#microarchitecture-mul-div-native-design-__codelineno-5-30"></a><span class="w">                </span><span class="n">rem_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">diff_ext</span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#microarchitecture-mul-div-native-design-__codelineno-5-31"></a><span class="w">                </span><span class="n">quot_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">quot_out</span><span class="p">[</span><span class="n">width</span><span class="o">-</span><span class="mh">2</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">};</span>
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#microarchitecture-mul-div-native-design-__codelineno-5-32"></a><span class="w">            </span><span class="k">end</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#microarchitecture-mul-div-native-design-__codelineno-5-33"></a><span class="w">                </span><span class="c1">// Result Negative: Keep Remainder, Shift 0 into Quotient</span>
</span><span id="__span-5-34"><a id="__codelineno-5-34" name="__codelineno-5-34" href="#microarchitecture-mul-div-native-design-__codelineno-5-34"></a><span class="w">                </span><span class="n">quot_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">quot_out</span><span class="p">[</span><span class="n">width</span><span class="o">-</span><span class="mh">2</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">};</span>
</span><span id="__span-5-35"><a id="__codelineno-5-35" name="__codelineno-5-35" href="#microarchitecture-mul-div-native-design-__codelineno-5-35"></a><span class="w">            </span><span class="k">end</span>
</span><span id="__span-5-36"><a id="__codelineno-5-36" name="__codelineno-5-36" href="#microarchitecture-mul-div-native-design-__codelineno-5-36"></a>
</span><span id="__span-5-37"><a id="__codelineno-5-37" name="__codelineno-5-37" href="#microarchitecture-mul-div-native-design-__codelineno-5-37"></a><span class="w">            </span><span class="c1">// 3. Shift Divisor Right for the next step</span>
</span><span id="__span-5-38"><a id="__codelineno-5-38" name="__codelineno-5-38" href="#microarchitecture-mul-div-native-design-__codelineno-5-38"></a><span class="w">            </span><span class="n">div_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">div_out</span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">1</span><span class="p">]};</span>
</span><span id="__span-5-39"><a id="__codelineno-5-39" name="__codelineno-5-39" href="#microarchitecture-mul-div-native-design-__codelineno-5-39"></a><span class="w">        </span><span class="k">end</span>
</span><span id="__span-5-40"><a id="__codelineno-5-40" name="__codelineno-5-40" href="#microarchitecture-mul-div-native-design-__codelineno-5-40"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-5-41"><a id="__codelineno-5-41" name="__codelineno-5-41" href="#microarchitecture-mul-div-native-design-__codelineno-5-41"></a><span class="k">endmodule</span>
</span></code></pre></div>
<p>To use the result from the divider unit, the state machine control can just be modified by updating the current remainder and quotient to be the result from the divider unit after each cycle:</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#microarchitecture-mul-div-native-design-__codelineno-6-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#microarchitecture-mul-div-native-design-__codelineno-6-2"></a><span class="w">    </span><span class="n">rem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">next_rem</span><span class="p">;</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#microarchitecture-mul-div-native-design-__codelineno-6-3"></a><span class="w">    </span><span class="n">div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">next_div</span><span class="p">;</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#microarchitecture-mul-div-native-design-__codelineno-6-4"></a><span class="w">    </span><span class="n">div_result_buf</span><span class="p">[</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">next_quot</span><span class="p">;</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#microarchitecture-mul-div-native-design-__codelineno-6-5"></a><span class="w">    </span><span class="n">div_result_buf</span><span class="p">[</span><span class="mh">2</span><span class="o">*</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="n">width</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rem</span><span class="p">[</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#microarchitecture-mul-div-native-design-__codelineno-6-6"></a><span class="k">end</span>
</span></code></pre></div>
<p>And finally, this divider unit is implemented as follows in the <code>MCycle</code> module:</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#microarchitecture-mul-div-native-design-__codelineno-7-1"></a><span class="n">DivSlice8</span><span class="w"> </span><span class="n">div_unit</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#microarchitecture-mul-div-native-design-__codelineno-7-2"></a><span class="w">    </span><span class="p">.</span><span class="n">rem_in</span><span class="w">  </span><span class="p">(</span><span class="n">rem</span><span class="p">),</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#microarchitecture-mul-div-native-design-__codelineno-7-3"></a><span class="w">    </span><span class="p">.</span><span class="n">div_in</span><span class="w">  </span><span class="p">(</span><span class="n">div</span><span class="p">),</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#microarchitecture-mul-div-native-design-__codelineno-7-4"></a><span class="w">    </span><span class="p">.</span><span class="n">quot_in</span><span class="w"> </span><span class="p">(</span><span class="n">div_result_buf</span><span class="p">[</span><span class="n">width</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]),</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#microarchitecture-mul-div-native-design-__codelineno-7-5"></a><span class="w">    </span><span class="p">.</span><span class="n">rem_out</span><span class="w"> </span><span class="p">(</span><span class="n">next_rem</span><span class="p">),</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#microarchitecture-mul-div-native-design-__codelineno-7-6"></a><span class="w">    </span><span class="p">.</span><span class="n">div_out</span><span class="w"> </span><span class="p">(</span><span class="n">next_div</span><span class="p">),</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#microarchitecture-mul-div-native-design-__codelineno-7-7"></a><span class="w">    </span><span class="p">.</span><span class="n">quot_out</span><span class="p">(</span><span class="n">next_quot</span><span class="p">)</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#microarchitecture-mul-div-native-design-__codelineno-7-8"></a><span class="p">);</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using the unrolling techniue in the divider unit here will use a lot of hardware! iirc, the propagation delay is around 66ns for this design! Given that high propagation delay, it is impossible to use this design on Hydra-V. So, I moved on to the next section, which is to use Xilinix IP core for the multiply and divide unit.</p>
</div></section></section></section><section class="print-page" id="sim-simulation" heading-number="3"><h1 id="sim-simulation-verification-simulation">Verification &amp; Simulation<a class="headerlink" href="#sim-simulation-verification-simulation" title="Permanent link">&para;</a></h1>
<p>This section outlines the verification strategy for the Hydra-V processor, including unit testing and full system simulation.</p>
<h2 id="sim-simulation-simulation-directory-structure">Simulation Directory Structure<a class="headerlink" href="#sim-simulation-simulation-directory-structure" title="Permanent link">&para;</a></h2>
<p>The <code>sim/</code> directory contains all testbench and verification artifacts:</p>
<ul>
<li><strong><code>sim/tb/</code></strong>: Verilog testbenches for individual modules (ALU, RegFile) and the top-level core.</li>
<li><strong><code>sim/hex/</code></strong>: Pre-compiled hexadecimal files (machine code) loaded into instruction memory for simulation.</li>
</ul>
<h2 id="sim-simulation-prerequisites">Prerequisites<a class="headerlink" href="#sim-simulation-prerequisites" title="Permanent link">&para;</a></h2>
<p>Ensure you have the following tools installed:</p>
<ol>
<li><strong>Xilinx Vivado</strong> (for Behavioral Simulation)</li>
<li><strong>Verilator</strong> (Optional, for faster C++ based simulation)</li>
<li><strong>GTKWave</strong> (for viewing waveform dumps outside Vivado)</li>
</ol>
<h2 id="sim-simulation-running-simulations">Running Simulations<a class="headerlink" href="#sim-simulation-running-simulations" title="Permanent link">&para;</a></h2>
<h3 id="sim-simulation-unit-level-testing">Unit Level Testing<a class="headerlink" href="#sim-simulation-unit-level-testing" title="Permanent link">&para;</a></h3>
<p>Unit tests verify specific components before integration.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#sim-simulation-__codelineno-0-1"></a><span class="c1"># Example: Running the ALU testbench</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#sim-simulation-__codelineno-0-2"></a><span class="nb">cd</span><span class="w"> </span>sim/tb
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#sim-simulation-__codelineno-0-3"></a>xvlog<span class="w"> </span>alu.v<span class="w"> </span>alu_tb.v
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#sim-simulation-__codelineno-0-4"></a>xelab<span class="w"> </span>-debug<span class="w"> </span>typical<span class="w"> </span>alu_tb<span class="w"> </span>-s<span class="w"> </span>alu_sim
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#sim-simulation-__codelineno-0-5"></a>xsim<span class="w"> </span>alu_sim<span class="w"> </span>-R
</span></code></pre></div>
<h3 id="sim-simulation-top-level-system-test">Top Level System Test<a class="headerlink" href="#sim-simulation-top-level-system-test" title="Permanent link">&para;</a></h3>
<p>To verify the full processor pipeline:</p>
<ol>
<li>Load a program hex file into <code>sim/hex/main.hex</code>.</li>
<li>Run the top-level testbench <code>tb_core.v</code>.</li>
<li>Observe the <code>d_mem</code> and register file changes.</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Debugging with Waveforms</p>
<p>If the processor stalls, check the stall_signal and flush lines in the Waveform viewer. A permanent high signal usually indicates a lockup in the Hazard Unit.</p>
</div></section>
                    <section class='print-page md-section' id='section-4' heading-number='4'>
                        <h1>Software<a class='headerlink' href='#section-4' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="sw-benchmark" heading-number="4.1"><h1 id="sw-benchmark-software-development-guide">Software Development Guide<a class="headerlink" href="#sw-benchmark-software-development-guide" title="Permanent link">&para;</a></h1>
<p>This guide explains how to write, compile, and run the Coremark Benchmark on the Hydra-V processor.</p>
<h2 id="sw-benchmark-software-directory-structure">Software Directory Structure<a class="headerlink" href="#sw-benchmark-software-directory-structure" title="Permanent link">&para;</a></h2>
<p>The <code>sw/</code> directory is organized by application:</p>
<ul>
<li><strong><code>sw/coremark/</code></strong>: The industry-standard CoreMark benchmark ported for this microarchitecture.</li>
</ul>
<h2 id="sw-benchmark-memory-map">Memory Map<a class="headerlink" href="#sw-benchmark-memory-map" title="Permanent link">&para;</a></h2>
<p>The processor uses a flat 32-bit address space.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Address Range</th>
<th style="text-align: left;">Size</th>
<th style="text-align: left;">Device</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>0x0000_0000</code></td>
<td style="text-align: left;">64 KB</td>
<td style="text-align: left;"><strong>Instruction Memory</strong></td>
<td style="text-align: left;">Read-Only program storage (BRAM).</td>
</tr>
<tr>
<td style="text-align: left;"><code>0x0010_0000</code></td>
<td style="text-align: left;">64 KB</td>
<td style="text-align: left;"><strong>Data Memory</strong></td>
<td style="text-align: left;">Read/Write RAM for stack and variables.</td>
</tr>
<tr>
<td style="text-align: left;"><code>0x8000_0000</code></td>
<td style="text-align: left;">4 B</td>
<td style="text-align: left;"><strong>GPIO_LEDS</strong></td>
<td style="text-align: left;">Write logic <code>1</code> to turn on board LEDs.</td>
</tr>
<tr>
<td style="text-align: left;"><code>0x8000_0004</code></td>
<td style="text-align: left;">4 B</td>
<td style="text-align: left;"><strong>UART_TX</strong></td>
<td style="text-align: left;">Write a character (byte) to send via Serial.</td>
</tr>
</tbody>
</table>
<h2 id="sw-benchmark-toolchain-setup">Toolchain Setup<a class="headerlink" href="#sw-benchmark-toolchain-setup" title="Permanent link">&para;</a></h2>
<p>You need the RISC-V GNU Toolchain to compile C code into machine code.</p>
<ol>
<li>
<p><strong>Install Toolchain:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#sw-benchmark-__codelineno-0-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>gcc-riscv64-unknown-elf
</span></code></pre></div>
</li>
<li>
<p><strong>Compilation Steps:</strong>
    We treat the processor as "Bare Metal" (no Operating System).</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#sw-benchmark-__codelineno-1-1"></a><span class="c1"># 1. Compile C to Object</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#sw-benchmark-__codelineno-1-2"></a>riscv64-unknown-elf-gcc<span class="w"> </span>-march<span class="o">=</span>rv32i<span class="w"> </span>-mabi<span class="o">=</span>ilp32<span class="w"> </span>-c<span class="w"> </span>main.c<span class="w"> </span>-o<span class="w"> </span>main.o
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#sw-benchmark-__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#sw-benchmark-__codelineno-1-4"></a><span class="c1"># 2. Link (using custom linker script)</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#sw-benchmark-__codelineno-1-5"></a>riscv64-unknown-elf-ld<span class="w"> </span>-T<span class="w"> </span>linker.ld<span class="w"> </span>main.o<span class="w"> </span>-o<span class="w"> </span>main.elf
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#sw-benchmark-__codelineno-1-6"></a>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#sw-benchmark-__codelineno-1-7"></a><span class="c1"># 3. Generate Hex File (for Verilog $readmemh)</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#sw-benchmark-__codelineno-1-8"></a>riscv64-unknown-elf-objcopy<span class="w"> </span>-O<span class="w"> </span>verilog<span class="w"> </span>main.elf<span class="w"> </span>main.hex
</span></code></pre></div>
</li>
</ol></section><section class="print-page" id="sw-contributing" heading-number="4.3"><h1 id="sw-contributing-documentation-workflow">Documentation Workflow<a class="headerlink" href="#sw-contributing-documentation-workflow" title="Permanent link">&para;</a></h1>
<p>The Hydra-V documentation uses <a href="https://github.com/jimporter/mike">mike</a> to manage multiple versions (e.g., <code>1.0</code>, <code>dev</code>). This process is automated via GitHub Actions.</p>
<h2 id="sw-contributing-1-daily-development-dev">1. Daily Development (<code>dev</code>)<a class="headerlink" href="#sw-contributing-1-daily-development-dev" title="Permanent link">&para;</a></h2>
<p>Any commit pushed to the <code>main</code> branch automatically triggers a deployment to the <strong>dev</strong> version.</p>
<ul>
<li><strong>URL:</strong> <code>.../Hydra-V/dev/</code></li>
<li><strong>Behavior:</strong> This version is mutable. New pushes overwrite the previous <code>dev</code> content.</li>
</ul>
<h2 id="sw-contributing-2-publishing-a-release-vxx">2. Publishing a Release (<code>vX.X</code>)<a class="headerlink" href="#sw-contributing-2-publishing-a-release-vxx" title="Permanent link">&para;</a></h2>
<p>To "freeze" the documentation for a specific processor version (e.g., when Version 1.0 RTL is complete), use <strong>Git Tags</strong>. The CI pipeline detects tags starting with <code>v</code> and creates a permanent documentation snapshot.</p>
<p><strong>Steps to release:</strong></p>
<ol>
<li>Commit your final changes.</li>
<li>Tag the commit with the version number (e.g., <code>v1.0</code>).</li>
<li>Push the tag to GitHub.</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#sw-contributing-__codelineno-0-1"></a><span class="c1"># Example: Releasing Version 1.0</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#sw-contributing-__codelineno-0-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-am<span class="w"> </span><span class="s2">&quot;Finalize RTL and Docs for v1.0&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#sw-contributing-__codelineno-0-3"></a>git<span class="w"> </span>tag<span class="w"> </span>v1.0
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#sw-contributing-__codelineno-0-4"></a>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>v1.0
</span></code></pre></div>
<p><strong>Results:</strong></p>
<ul>
<li>A new folder <code>/1.0/</code> is created in the documentation.</li>
<li>The <code>latest</code> alias is updated to point to <code>1.0</code>.</li>
<li>The default landing page is switched to <code>1.0</code>.</li>
</ul>
<h2 id="sw-contributing-3-pdf-offline-access">3. PDF / Offline Access<a class="headerlink" href="#sw-contributing-3-pdf-offline-access" title="Permanent link">&para;</a></h2>
<p>The documentation supports exporting the entire site as a single consolidated PDF using the <a href="https://timvink.github.io/mkdocs-print-site-plugin/index.html"><code>mkdocs-print-site-plugin</code></a>.</p>
<p><strong>How to access:</strong>
There is currently no direct icon in the navigation bar. To access the printable version, you must manually navigate to the print page:</p>
<ol>
<li>
<p><strong>Navigate to the Print URL:</strong>
    Append <code>/print_page/</code> (or <code>print_page.html</code>) to the end of the current documentation URL.</p>
<ul>
<li><em>Example:</em> <code>.../Hydra-V/dev/print_page/</code></li>
</ul>
</li>
<li>
<p><strong>Save as PDF:</strong>
    Once the consolidated page loads (containing all documentation chapters), use your browser's print function:</p>
<ul>
<li>Press <code>Ctrl + P</code> (Windows/Linux) or <code>Cmd + P</code> (macOS).</li>
<li>Select <strong>"Save as PDF"</strong> as the destination.</li>
</ul>
</li>
</ol></section></section></div><style>.print-site-enumerate-headings #index > h1:before { content: '1 ' }

                .print-site-enumerate-headings #index h2:before { content: '1.' counter(counter-index-2) ' ' }
                .print-site-enumerate-headings #index h2 {  counter-reset: counter-index-3 ;  counter-increment: counter-index-2 }
            
                .print-site-enumerate-headings #index h3:before { content: '1.' counter(counter-index-2) '.' counter(counter-index-3) ' ' }
                .print-site-enumerate-headings #index h3 {  counter-increment: counter-index-3 }
            
.print-site-enumerate-headings #section-2 > h1:before { content: '2 ' }
.print-site-enumerate-headings #microarchitecture > h1:before { content: '2.1 ' }

                .print-site-enumerate-headings #microarchitecture h2:before { content: '2.1.' counter(counter-microarchitecture-2) ' ' }
                .print-site-enumerate-headings #microarchitecture h2 {  counter-increment: counter-microarchitecture-2 }
            
.print-site-enumerate-headings #section-2-2 > h1:before { content: '2.2 ' }
.print-site-enumerate-headings #microarchitecture-mul-div > h1:before { content: '2.2.1 ' }

.print-site-enumerate-headings #microarchitecture-mul-div-native-design > h1:before { content: '2.2.2 ' }

.print-site-enumerate-headings #microarchitecture-mul-div-vendor-ip > h1:before { content: '2.2.3 ' }
.print-site-enumerate-headings #sim-simulation > h1:before { content: '3 ' }

                .print-site-enumerate-headings #sim-simulation h2:before { content: '3.' counter(counter-sim-simulation-2) ' ' }
                .print-site-enumerate-headings #sim-simulation h2 {  counter-reset: counter-sim-simulation-3 ;  counter-increment: counter-sim-simulation-2 }
            
                .print-site-enumerate-headings #sim-simulation h3:before { content: '3.' counter(counter-sim-simulation-2) '.' counter(counter-sim-simulation-3) ' ' }
                .print-site-enumerate-headings #sim-simulation h3 {  counter-increment: counter-sim-simulation-3 }
            
.print-site-enumerate-headings #section-4 > h1:before { content: '4 ' }
.print-site-enumerate-headings #sw-benchmark > h1:before { content: '4.1 ' }

                .print-site-enumerate-headings #sw-benchmark h2:before { content: '4.1.' counter(counter-sw-benchmark-2) ' ' }
                .print-site-enumerate-headings #sw-benchmark h2 {  counter-increment: counter-sw-benchmark-2 }
            
.print-site-enumerate-headings #sw-uart_calculator > h1:before { content: '4.2 ' }
.print-site-enumerate-headings #sw-contributing > h1:before { content: '4.3 ' }

                .print-site-enumerate-headings #sw-contributing h2:before { content: '4.3.' counter(counter-sw-contributing-2) ' ' }
                .print-site-enumerate-headings #sw-contributing h2 {  counter-increment: counter-sw-contributing-2 }
            </style>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "/Hydra-V/dev", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "navigation.footer", "navigation.path", "navigation.indexes", "content.code.copy", "content.action.edit"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "dev", "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../js/timeago.min.js"></script>
      
        <script src="../js/timeago_mkdocs_material.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>